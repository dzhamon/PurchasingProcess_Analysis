"""
–ú–æ–¥—É–ª—å –¥–ª—è —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ - –í–ï–†–°–ò–Ø 3.18

–û–¢–í–û–î–´ - —É–∂–µ—Å—Ç–æ—á–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–∞–º–µ—Ç—Ä–∞ (–∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–æ—Ä–æ–≥–∏)

–ò–ó–ú–ï–ù–ï–ù–ò–Ø –í v3.18:
üî• –£–ñ–ï–°–¢–û–ß–ï–ù–ê –ü–†–û–í–ï–†–ö–ê –û–¢–í–û–î–û–í - –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–æ—Ä–æ–≥–∏:

  –ß–µ–º –º–µ–Ω—å—à–µ –¥–∏–∞–º–µ—Ç—Ä, —Ç–µ–º —Å—Ç—Ä–æ–∂–µ –ø—Ä–æ–≤–µ—Ä–∫–∞:

  1. **–û—á–µ–Ω—å –º–∞–ª—ã–µ –æ—Ç–≤–æ–¥—ã** (<50–º–º): —Ä–∞–∑–Ω–∏—Ü–∞ >=1.5–º–º ‚Üí –†–ê–ó–ù–´–ï
     –û—Ç–≤–æ–¥ 26.9√ó3.2 vs 25√ó4 ‚Üí 30% (—Ä–∞–∑–Ω–∏—Ü–∞ 1.9–º–º) ‚úÖ
     –û—Ç–≤–æ–¥ 21.3√ó3.2 vs 25√ó4 ‚Üí 30% (—Ä–∞–∑–Ω–∏—Ü–∞ 3.7–º–º) ‚úÖ

  2. **–ú–∞–ª—ã–µ –æ—Ç–≤–æ–¥—ã** (50-100–º–º): —Ä–∞–∑–Ω–∏—Ü–∞ >=3–º–º ‚Üí –†–ê–ó–ù–´–ï
     –û—Ç–≤–æ–¥ 60.3√ó4 vs 57√ó4 ‚Üí 30% (—Ä–∞–∑–Ω–∏—Ü–∞ 3.3–º–º) ‚úÖ
     –û—Ç–≤–æ–¥ 76√ó5 vs 80√ó5 ‚Üí 30% (—Ä–∞–∑–Ω–∏—Ü–∞ 4–º–º) ‚úÖ

  3. **–ë–æ–ª—å—à–∏–µ –æ—Ç–≤–æ–¥—ã** (>=100–º–º): —Ä–∞–∑–Ω–∏—Ü–∞ >=5–º–º ‚Üí –†–ê–ó–ù–´–ï
     –û—Ç–≤–æ–¥ 159√ó7 vs 219√ó7 ‚Üí 30% (—Ä–∞–∑–Ω–∏—Ü–∞ 60–º–º) ‚úÖ

  –ü–û–ß–ï–ú–£ –ê–î–ê–ü–¢–ò–í–ù–´–ï –ü–û–†–û–ì–ò:
  - –î–ª—è –æ—Ç–≤–æ–¥–∞ 25–º–º: —Ä–∞–∑–Ω–∏—Ü–∞ 2–º–º = 8% (–∫—Ä–∏—Ç–∏—á–Ω–æ!)
  - –î–ª—è –æ—Ç–≤–æ–¥–∞ 200–º–º: —Ä–∞–∑–Ω–∏—Ü–∞ 2–º–º = 1% (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)

–ò–°–¢–û–†–ò–Ø –í–ï–†–°–ò–ô:
v3.17: –û–¢–í–û–î–´ - —É–≥–æ–ª, –¥–∏–∞–º–µ—Ç—Ä, —Ç–æ–ª—â–∏–Ω–∞, —Ç–∏–ø
v3.18: –û–¢–í–û–î–´ - –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–æ—Ä–æ–≥–∏ –¥–ª—è –¥–∏–∞–º–µ—Ç—Ä–∞ ‚Üê –ù–û–í–û–ï
v3.16: –ó–ê–ì–õ–£–®–ö–ò - –î—É + –†—É
v3.13: –õ–ò–°–¢–´ + —Ç—Ä—É–±—ã

–ö–†–ò–¢–ò–ß–ù–´–ï –ü–ê–†–ê–ú–ï–¢–†–´ (33 —Ç–∏–ø–∞):
19b. –û–¢–í–û–î–´ - —É–≥–æ–ª, –¥–∏–∞–º–µ—Ç—Ä (–∞–¥–∞–ø—Ç–∏–≤–Ω–æ), —Ç–æ–ª—â–∏–Ω–∞, —Ç–∏–ø ‚Üê –û–ë–ù–û–í–õ–ï–ù–û

–î–∞—Ç–∞: 28.11.2024
–°—Ç–∞—Ç—É—Å: Production Ready ‚úÖ –¥–ª—è –Ω–µ—Ñ—Ç–µ–≥–∞–∑–æ–≤–æ–π –æ—Ç—Ä–∞—Å–ª–∏
–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ: 1,162+ –ø–∞—Ä —Ä–µ–∞–ª—å–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
"""

import re
from typing import Dict, Any, List, Tuple, Optional
from difflib import SequenceMatcher


class ProductMatcher:
    """–ö–ª–∞—Å—Å –¥–ª—è —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∏ –∞–Ω–∞–ª–∏–∑–∞ —Ç–æ–≤–∞—Ä–æ–≤"""

    # –†–ê–°–®–ò–†–ï–ù–ù–´–ï –ö–ê–¢–ï–ì–û–†–ò–ò —Å –Ω–æ–≤—ã–º–∏ —Ç–∏–ø–∞–º–∏ —Ç–æ–≤–∞—Ä–æ–≤
    CATEGORIES = {
        '–º–µ—Ç–∞–ª–ª–æ–ø—Ä–æ–∫–∞—Ç': [
            '—Ç—Ä—É–±–∞', '—à–≤–µ–ª–ª–µ—Ä', '–¥–≤—É—Ç–∞–≤—Ä', '–∞—Ä–º–∞—Ç—É—Ä–∞', '—É–≥–æ–ª–æ–∫', '–±–∞–ª–∫–∞',
            '–ø—Ä–æ—Ñ–∏–ª—å', '–ª–∏—Å—Ç', '–ø–æ–ª–æ—Å–∞', '–∫—Ä—É–≥', '–ø—Ä–æ–≤–æ–ª–æ–∫–∞', '–∫–∞—Ç–∞–Ω–∫–∞',
            '—Ç–∞–≤—Ä', '–ø—Ä–æ–∫–∞—Ç', '–º–µ—Ç–∞–ª–ª–æ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è', '—Å—Ç–∞–ª—å'
        ],
        '—Ç—Ä—É–±—ã_—Ñ–∏—Ç–∏–Ω–≥–∏': [
            '—Ç—Ä—É–±–∞', '–æ—Ç–≤–æ–¥', '—Ç—Ä–æ–π–Ω–∏–∫', '–ø–µ—Ä–µ—Ö–æ–¥', '—Ñ–ª–∞–Ω–µ—Ü', '–º—É—Ñ—Ç–∞',
            '–∑–∞–≥–ª—É—à–∫–∞', '–∫–æ–ª–µ–Ω–æ', '–ø–∞—Ç—Ä—É–±–æ–∫', '—à—Ç—É—Ü–µ—Ä', '–Ω–∏–ø–ø–µ–ª—å', '—Ñ—É—Ç–æ—Ä–∫–∞',
            '–∞–¥–∞–ø—Ç–µ—Ä', '–∞–º–µ—Ä–∏–∫–∞–Ω–∫–∞', '–ø–ø—Ä', '–ø–≤—Ö', '—Ñ–∏—Ç–∏–Ω–≥–∏', '—Ñ–∏—Ç–∏–Ω–≥'
        ],
        '–∫—Ä–µ–ø–µ–∂': [
            '–±–æ–ª—Ç', '–≥–∞–π–∫–∞', '—à–∞–π–±–∞', '–≤–∏–Ω—Ç', '—Å–∞–º–æ—Ä–µ–∑', '—à—É—Ä—É–ø', '–≥–≤–æ–∑–¥—å',
            '–∞–Ω–∫–µ—Ä', '–¥—é–±–µ–ª—å', '—à–ø–∏–ª—å–∫–∞', '–∑–∞–∫–ª–µ–ø–∫–∞', '—Å–∫–æ–±–∞', '—Ö–æ–º—É—Ç',
            '–∫–ª–∏–ø—Å–∞', '—Å—Ç—è–∂–∫–∞', '—Ç–∞–ª—Ä–µ–ø', '–∑–∞–∂–∏–º', '–∫–æ—É—à'
        ],
        '—ç–ª–µ–∫—Ç—Ä–∏–∫–∞': [
            '–∫–∞–±–µ–ª—å', '–ø—Ä–æ–≤–æ–¥', '—Ä–æ–∑–µ—Ç–∫–∞', '–≤—ã–∫–ª—é—á–∞—Ç–µ–ª—å', '–ª–∞–º–ø–∞', '—Å–≤–µ—Ç–∏–ª—å–Ω–∏–∫',
            '—â–∏—Ç', '–∞–≤—Ç–æ–º–∞—Ç', '–∫–æ–Ω—Ç–∞–∫—Ç–æ—Ä', '–ø—É—Å–∫–∞—Ç–µ–ª—å', '—Ä–µ–ª–µ', '—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ç–æ—Ä',
            '—Å—á–µ—Ç—á–∏–∫', '–¥–∞—Ç—á–∏–∫', '–∏–∑–≤–µ—â–∞—Ç–µ–ª—å', '–ø—Ä–æ–∂–µ–∫—Ç–æ—Ä', '–ø–∞—Ç—Ä–æ–Ω',
            '–∫–æ–º–º—É—Ç–∞—Ç–æ—Ä', '–∞–¥–∞–ø—Ç–µ—Ä sc', '–Ω–∞–∫–æ–Ω–µ—á–Ω–∏–∫', '–∏–∑–æ–ª—è—Ç–æ—Ä'
        ],
        '—Å–∞–Ω—Ç–µ—Ö–Ω–∏–∫–∞': [
            '—Å–º–µ—Å–∏—Ç–µ–ª—å', '—É–Ω–∏—Ç–∞–∑', '—Ä–∞–∫–æ–≤–∏–Ω–∞', '–≤–∞–Ω–Ω–∞', '–¥—É—à', '—Å–∏—Ñ–æ–Ω',
            '—É–º—ã–≤–∞–ª—å–Ω–∏–∫', '–ø–∏—Å—Å—É–∞—Ä', '–∫—Ä–∞–Ω', '–≤–µ–Ω—Ç–∏–ª—å', '–∑–∞–¥–≤–∏–∂–∫–∞',
            '—Ç—Ä–∞–ø', '—Ä–µ—à–µ—Ç–∫–∞', '–º–æ–π–∫–∞', '–≥–æ—Ñ—Ä–∞', '—Ä–µ–≤–∏–∑–∏—è', '–≤–æ–¥–æ–Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—å'
        ],
        '–∫–ª–∞–ø–∞–Ω—ã_–∞—Ä–º–∞—Ç—É—Ä–∞': [
            '–∫–ª–∞–ø–∞–Ω', '–≤–µ–Ω—Ç–∏–ª—å', '–∑–∞–¥–≤–∏–∂–∫–∞', '–∫—Ä–∞–Ω', '–∑–∞—Ç–≤–æ—Ä', '—Ä–µ–¥—É–∫—Ç–æ—Ä',
            '—Ä–µ–≥—É–ª—è—Ç–æ—Ä', '–º–∞–Ω–æ–º–µ—Ç—Ä', '—Ç–µ—Ä–º–æ–º–µ—Ç—Ä', '—Å—á–µ—Ç—á–∏–∫', '–æ–±—Ä–∞—Ç–Ω—ã–π',
            '–ø—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—å–Ω—ã–π', '–∑–∞–ø–æ—Ä–Ω—ã–π', '–≥–æ–ª–æ–≤–∫–∞ –ø–æ–∂–∞—Ä–Ω–∞—è'
        ],
        '—Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–µ_–º–∞—Ç–µ—Ä–∏–∞–ª—ã': [
            '—Ü–µ–º–µ–Ω—Ç', '–±–µ—Ç–æ–Ω', '—Ä–∞—Å—Ç–≤–æ—Ä', '—Å–º–µ—Å—å', '–ø–µ—Å–æ–∫', '—â–µ–±–µ–Ω—å', '–≥—Ä–∞–≤–∏–π',
            '–∫–∏—Ä–ø–∏—á', '–±–ª–æ–∫', '–ø–ª–∏—Ç–∞', '–ø–∞–Ω–µ–ª—å', '–≥–∏–ø—Å–æ–∫–∞—Ä—Ç–æ–Ω', '—É—Ç–µ–ø–ª–∏—Ç–µ–ª—å',
            '–º–∏–Ω–≤–∞—Ç–∞', '–ø–µ–Ω–æ–ø–ª–∞—Å—Ç', '–ø–µ–Ω–æ–ø–ª–µ–∫—Å', '—Å—ç–Ω–¥–≤–∏—á-–ø–∞–Ω–µ–ª—å', '—Å—ç–Ω–¥–≤–∏—á',
            '—Å–µ–Ω–¥–≤–∏—á-–ø–∞–Ω–µ–ª—å', '—Å–µ–Ω–¥–≤–∏—á', '–ø—Ä–æ—Ñ–Ω–∞—Å—Ç–∏–ª', '–≥–µ–æ—Ç–µ–∫—Å—Ç–∏–ª—å', '–ø–ª–µ–Ω–∫–∞',
            '–±—Ä–µ–∑–µ–Ω—Ç', '–±—Ä—É—Å', '–¥–æ—Å–∫–∞', '–∫–æ–ª—å—Ü–æ —Å—Ç–µ–Ω–æ–≤–æ–µ', '–¥–Ω–∏—â–µ', '—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç',
            '–æ–ø–æ—Ä–∞', '—Å—Ç–æ–π–∫–∞', '–∫–ª–µ–π', '–¥–æ–±–∞–≤–∫–∞', '–≥–∏–ø–µ—Ä', '—à–ø–∞–∫–ª—ë–≤–∫–∞'
        ],
        '–ª–∫–º': [
            '–∫—Ä–∞—Å–∫–∞', '—ç–º–∞–ª—å', '–≥—Ä—É–Ω—Ç–æ–≤–∫–∞', '–ª–∞–∫', '—à–ø–∞—Ç–ª–µ–≤–∫–∞', '–≥–µ—Ä–º–µ—Ç–∏–∫',
            '—Ä–∞—Å—Ç–≤–æ—Ä–∏—Ç–µ–ª—å', '—Ä–∞–∑–±–∞–≤–∏—Ç–µ–ª—å', '–æ–ª–∏—Ñ–∞', '–º–∞—Å—Ç–∏–∫–∞', '–ø—Ä–∞–π–º–µ—Ä',
            '–±–∏—Ç—É–º', '—Å–º–æ–ª–∞'
        ],
        '–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç': [
            '–¥—Ä–µ–ª—å', '–ø–µ—Ä—Ñ–æ—Ä–∞—Ç–æ—Ä', '—à—É—Ä—É–ø–æ–≤–µ—Ä—Ç', '–±–æ–ª–≥–∞—Ä–∫–∞', '—É—à–º', '–ø–∏–ª–∞',
            '–ª–æ–±–∑–∏–∫', '—Ñ—Ä–µ–∑–µ—Ä', '—Ä—É–±–∞–Ω–æ–∫', '–º–æ–ª–æ—Ç–æ–∫', '–∫–ª—é—á', '–æ—Ç–≤–µ—Ä—Ç–∫–∞',
            '–ø–ª–æ—Å–∫–æ–≥—É–±—Ü—ã', '–∫—É—Å–∞—á–∫–∏', '–Ω–æ–∂–Ω–∏—Ü—ã', '–Ω–æ–∂', '–≥–æ–ª–æ–≤–∫–∞ —Ç–æ—Ä—Ü–µ–≤–∞—è',
            '–Ω–∞–±–æ—Ä', '—Å–≤–µ—Ä–ª–æ', '–¥–∏—Å–∫', '–º–∞—à–∏–Ω–∞ —à–ª–∏—Ñ–æ–≤–∞–ª—å–Ω–∞—è', '–º–∞—à–∏–Ω–∫–∞',
            '–≥–∞–π–∫–æ–≤–µ—Ä—Ç', '–º–∏–∫—Å–µ—Ä', '—Ç—Ä—É–±–æ–≥–∏–±', '—à–∞—Ä–æ—à–∫–∞', '–±–∏—Ç–∞'
        ],
        '–≥—Ä—É–∑–æ–ø–æ–¥—ä–µ–º–Ω–æ–µ_–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ': [
            '—Å—Ç—Ä–æ–ø', '—Å—Ç—Ä–æ–ø–∞', '—Å—Ç—Ä–æ–ø—ã', '—Ç–∞–ª—å', '–ª–µ–±–µ–¥–∫–∞', '–¥–æ–º–∫—Ä–∞—Ç',
            '—Å–µ—Ä—å–≥–∞', '–∑–∞—Ö–≤–∞—Ç', '—à—Ç–∞–±–µ–ª–µ—Ä', '—Å—Ç—è–∂–Ω', '–ø–æ–¥–≤–µ—Å', '—Ç—Ä–∞–≤–µ—Ä—Å–∞'
        ],
        '–∏–∑–º–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ_–ø—Ä–∏–±–æ—Ä—ã': [
            '–º–∞–Ω–æ–º–µ—Ç—Ä', '—Ç–µ—Ä–º–æ–º–µ—Ç—Ä', '—Ä–∞—Å—Ö–æ–¥–æ–º–µ—Ä', '—Å—á–µ—Ç—á–∏–∫', '–¥–∞—Ç—á–∏–∫',
            '—É—Ä–æ–≤–µ–Ω—å', '—Ä—É–ª–µ—Ç–∫–∞', '—à—Ç–∞–Ω–≥–µ–Ω—Ü–∏—Ä–∫—É–ª—å', '–Ω–∏–≤–µ–ª–∏—Ä', '–º—É–ª—å—Ç–∏–º–µ—Ç—Ä',
            '—Ç–µ—Å—Ç–µ—Ä', '–≤–æ–ª—å—Ç–º–µ—Ç—Ä', '–∞–º–ø–µ—Ä–º–µ—Ç—Ä', '–ª–∏–Ω–µ–π–∫–∞', '–∑–µ—Ä–∫–∞–ª–æ'
        ],
        '—Å–ø–µ—Ü–æ–¥–µ–∂–¥–∞_—Å–∏–∑': [
            '–∫–æ—Å—Ç—é–º', '–∫–æ–º–±–∏–Ω–µ–∑–æ–Ω', '–∫—É—Ä—Ç–∫–∞', '–±—Ä—é–∫–∏', '—Ö–∞–ª–∞—Ç', '—Ä–æ–±–∞',
            '–ø–µ—Ä—á–∞—Ç–∫–∏', '–∫–∞—Å–∫–∞', '–æ—á–∫–∏', '—Ä–µ—Å–ø–∏—Ä–∞—Ç–æ—Ä', '–º–∞—Å–∫–∞', '–ø—Ä–æ—Ç–∏–≤–æ–≥–∞–∑',
            '–±–µ—Ä—É—à–∏', '–Ω–∞—É—à–Ω–∏–∫–∏', '–∫–∞—Å–∫–∏', '—à–ª–µ–º', '—Å–ø–µ—Ü–æ–¥–µ–∂–¥–∞', '—Å–ø–µ—Ü –æ–¥–µ–∂–¥–∞',
            '—Å–ø–µ—Ü –æ–±—É–≤—å', '—Ñ–∏–ª—å—Ç—Ä'
        ],
        '–ø–æ–∂–∞—Ä–Ω–æ–µ_–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ': [
            '–æ–≥–Ω–µ—Ç—É—à–∏—Ç–µ–ª—å', '—Ä—É–∫–∞–≤', '—Å—Ç–≤–æ–ª', '–≥–∏–¥—Ä–∞–Ω—Ç', '–∫—Ä–∞–Ω', '–∏–∑–≤–µ—â–∞—Ç–µ–ª—å',
            '–æ–ø–æ–≤–µ—â–∞—Ç–µ–ª—å', '–¥–∞—Ç—á–∏–∫', '—â–∏—Ç', '—à–∫–∞—Ñ', '—è—â–∏–∫', '–∫–æ—à–º–∞',
            '–ø–æ–ª–æ—Ç–Ω–∏—â–µ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–∂–∞—Ä–Ω–æ–µ'
        ],
        '–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ': [
            '–Ω–∞—Å–æ—Å', '–∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä', '–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä', '—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ç–æ—Ä', '–¥–≤–∏–≥–∞—Ç–µ–ª—å',
            '—Ä–µ–¥—É–∫—Ç–æ—Ä', '–º–æ—Ç–æ—Ä', '–≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä', '–∫–∞–ª–æ—Ä–∏—Ñ–µ—Ä', '–∫–æ—Ç–µ–ª',
            '–≤–∏–±—Ä–∞—Ç–æ—Ä', '–º–æ—Ç–æ–ø–æ–º–ø–∞', '–ø—ã–ª–µ—Å–æ—Å'
        ],
        '—Å–≤–∞—Ä–æ—á–Ω–æ–µ_–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ': [
            '–∞–ø–ø–∞—Ä–∞—Ç —Å–≤–∞—Ä–æ—á–Ω—ã–π', '–∏–Ω–≤–µ—Ä—Ç–æ—Ä', '–ø–ª–∞–∑–º–æ—Ä–µ–∑', '–≥–æ—Ä–µ–ª–∫–∞', '–¥–µ—Ä–∂–∞–∫',
            '—ç–ª–µ–∫—Ç—Ä–æ–¥', '—Ñ–ª—é—Å', '—Å–æ–ø–ª–æ', '—Å–≤–∞—Ä–æ—á–Ω—ã–π', '—Å–æ–ø–ª–æ –¥–ª—è –∫—Ä–∞—Å–∫–æ–ø—É–ª—å—Ç–∞'
        ],
        '—Ä–∞—Å—Ö–æ–¥–Ω—ã–µ_–º–∞—Ç–µ—Ä–∏–∞–ª—ã': [
            '–¥–∏—Å–∫ –æ—Ç—Ä–µ–∑–Ω–æ–π', '–¥–∏—Å–∫ —à–ª–∏—Ñ–æ–≤–∞–ª—å–Ω—ã–π', '–¥–∏—Å–∫ –∞–ª–º–∞–∑–Ω—ã–π', '–∫—Ä—É–≥',
            '–Ω–∞–∂–¥–∞—á–Ω–∞—è', '–≤–∞–ª–∏–∫', '–∫–∏—Å—Ç—å', '—â–µ—Ç–∫–∞', '–ª–µ–Ω—Ç–∞', '—Å–∫–æ—Ç—á',
            '—Å–µ—Ä–ø—è–Ω–∫–∞', '–º–∞—Ä–∫–µ—Ä', '–º–µ–ª', '–∫—Ä–µ—Å—Ç–∏–∫–∏', '—Ä–µ–º–∫–æ–º–ø–ª–µ–∫—Ç', '—Å–∞–ª—å–Ω–∏–∫',
            '–ø—Ä–æ–∫–ª–∞–¥–∫–∞', '–≤—Ç—É–ª–∫–∞', '–ø–æ–¥—à–∏–ø–Ω–∏–∫', '—Ä–µ–º–µ–Ω—å', '—Ñ–∏–ª—å—Ç—Ä', '–≥–∏–ª—å–∑–∞'
        ],
        '—Ö–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã–µ_—Ç–æ–≤–∞—Ä—ã': [
            '–≤–µ—Ä–µ–≤–∫–∞', '–∫–∞–Ω–∞—Ç', '–∂–∏–ª–∫–∞', '–ª–µ—Å–∫–∞', '–ø–ª–µ–Ω–∫–∞', '–±—Ä–µ–∑–µ–Ω—Ç',
            '–ø–∞–ª–∞—Ç–∫–∞', '–¥–≤–µ—Ä—å', '–ø–ª–∏–Ω—Ç—É—Å', '—Å–æ–µ–¥–∏–Ω–∏—Ç–µ–ª—å', '–ª—é–∫', '–∫–æ–ª–µ—Å–æ',
            '–µ–º–∫–æ—Å—Ç—å', '—Ç–µ–ª–µ–∂–∫–∞', '–∑–Ω–∞–∫', '–∑–Ω–∞–∫ –¥–æ—Ä–æ–∂–Ω—ã–π', '—Å–µ—Ç–∫–∞'
        ],
        '–≥–∞–∑–æ–≤–æ–µ_–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ': [
            '–±–∞–ª–ª–æ–Ω', '—à–ª–∞–Ω–≥', '–≥–æ—Ä–µ–ª–∫–∞', '–≥–∞–∑–æ–≤—ã–π', '–ø—Ä–æ–ø–∞–Ω', '–∫–∏—Å–ª–æ—Ä–æ–¥',
            '–∞—Ä–≥–æ–Ω', '–∞–∑–æ—Ç', '—É–≥–ª–µ–∫–∏—Å–ª–æ—Ç–∞'
        ],
        '–ø–æ–∫—Ä–∞—Å–æ—á–Ω–æ–µ_–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ': [
            '–∫—Ä–∞—Å–∫–æ—Ä–∞—Å–ø—ã–ª–∏—Ç–µ–ª—å', '–ø—É–ª—å–≤–µ—Ä–∏–∑–∞—Ç–æ—Ä', '—Å–æ–ø–ª–æ', '—Ñ–∏–ª—å—Ç—Ä',
            '—à–ª–∞–Ω–≥ –≤—ã—Å–æ–∫–æ–≥–æ –¥–∞–≤–ª–µ–Ω–∏—è', '—Ç—Ä—É–±–∫–∞'
        ],
        '–ø—Ä–æ—á–µ–µ': [
            '–ø—Ä–æ—á–µ–µ', '—Ä–∞–∑–Ω–æ–µ', '–∏–Ω–æ–µ', '–¥—Ä—É–≥–æ–µ'
        ]
    }

    # –ï–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è
    UNITS = {
        'length': ['–º–º', '—Å–º', '–º', '–∫–º'],
        'weight': ['–≥', '–∫–≥', '—Ç', '—Ç–æ–Ω–Ω'],
        'volume': ['–ª', '–º–ª', '–º3', '–º¬≥'],
        'area': ['–º2', '–º¬≤', '—Å–º2', '—Å–º¬≤'],
        'power': ['–≤—Ç', '–∫–≤—Ç', '–º–≤—Ç', 'w', 'kw'],
        'voltage': ['–≤', '–∫–≤', 'v'],
        'current': ['–∞', '–º–∞', 'a'],
        'pressure': ['–±–∞—Ä', '–º–ø–∞', '–∞—Ç–º', 'bar', 'psi'],
        'temperature': ['¬∞c', '¬∞—Å', 'c', '—Å']
    }

    @staticmethod
    def extract_key_features(product_name: str) -> Dict[str, Any]:
        """
        –ò–∑–≤–ª–µ–∫–∞–µ—Ç –∫–ª—é—á–µ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞.

        Args:
            product_name: –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞

        Returns:
            dict: —Å–ª–æ–≤–∞—Ä—å —Å –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã–º–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏
        """
        name_lower = str(product_name).lower()

        features = {
            'type': None,
            'category': None,
            'diameter': None,
            'thickness': None,
            'length': None,
            'width': None,
            'height': None,
            'number': None,
            'material': None,
            'gost': None,
            'model': None,
            'brand': None,
            'specifications': [],
            'measurements': {}
        }

        # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —Ç–∏–ø–∞
        features['category'], features['type'] = ProductMatcher._extract_category_and_type(name_lower)

        # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤ –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
        features.update(ProductMatcher._extract_dimensions(name_lower))

        # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞
        features['material'] = ProductMatcher._extract_material(name_lower)

        # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ì–û–°–¢
        features['gost'] = ProductMatcher._extract_gost(name_lower)

        # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏/–∞—Ä—Ç–∏–∫—É–ª–∞
        features['model'] = ProductMatcher._extract_model(name_lower)

        # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –±—Ä–µ–Ω–¥–∞
        features['brand'] = ProductMatcher._extract_brand(name_lower)

        # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤—Å–µ—Ö —á–∏—Å–ª–æ–≤—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
        features['measurements'] = ProductMatcher._extract_all_measurements(name_lower)

        # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π (—Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã, –∫–ª–∞—Å—Å—ã, —Ç–∏–ø—ã)
        features['specifications'] = ProductMatcher._extract_specifications(name_lower)

        return features

    @staticmethod
    def _extract_category_and_type(name_lower: str) -> Tuple[Optional[str], Optional[str]]:
        """–ò–∑–≤–ª–µ–∫–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏ —Ç–∏–ø —Ç–æ–≤–∞—Ä–∞"""
        category = None
        product_type = None

        # –ò—â–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º (–ø–æ—Ä—è–¥–æ–∫ –≤–∞–∂–µ–Ω - –±–æ–ª–µ–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–µ—Ä–≤—ã–º–∏)
        category_priority = [
            '—Å–≤–∞—Ä–æ—á–Ω–æ–µ_–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ',
            '–≥—Ä—É–∑–æ–ø–æ–¥—ä–µ–º–Ω–æ–µ_–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ',
            '–ø–æ–∫—Ä–∞—Å–æ—á–Ω–æ–µ_–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ',
            '–≥–∞–∑–æ–≤–æ–µ_–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ',
            '—Ä–∞—Å—Ö–æ–¥–Ω—ã–µ_–º–∞—Ç–µ—Ä–∏–∞–ª—ã',
            '—Ç—Ä—É–±—ã_—Ñ–∏—Ç–∏–Ω–≥–∏',
            '–º–µ—Ç–∞–ª–ª–æ–ø—Ä–æ–∫–∞—Ç',
            '–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç',
            '–∫—Ä–µ–ø–µ–∂',
            '—ç–ª–µ–∫—Ç—Ä–∏–∫–∞',
            '—Å–∞–Ω—Ç–µ—Ö–Ω–∏–∫–∞',
            '–∫–ª–∞–ø–∞–Ω—ã_–∞—Ä–º–∞—Ç—É—Ä–∞',
            '—Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–µ_–º–∞—Ç–µ—Ä–∏–∞–ª—ã',
            '–ª–∫–º',
            '–∏–∑–º–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ_–ø—Ä–∏–±–æ—Ä—ã',
            '—Å–ø–µ—Ü–æ–¥–µ–∂–¥–∞_—Å–∏–∑',
            '–ø–æ–∂–∞—Ä–Ω–æ–µ_–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ',
            '–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ',
            '—Ö–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã–µ_—Ç–æ–≤–∞—Ä—ã',
            '–ø—Ä–æ—á–µ–µ'
        ]

        for cat in category_priority:
            keywords = ProductMatcher.CATEGORIES.get(cat, [])
            for keyword in keywords:
                # –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –∏—â–µ–º —Ü–µ–ª–æ–µ —Å–ª–æ–≤–æ, –∞ –Ω–µ –ø–æ–¥—Å—Ç—Ä–æ–∫—É!
                # "—Ç–∞–ª—å" –Ω–µ –¥–æ–ª–∂–Ω–∞ –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ "—Å—Ç–∞–ª—å–Ω–∞—è"
                pattern = r'\b' + re.escape(keyword) + r'\b'
                if re.search(pattern, name_lower):
                    if category is None:
                        category = cat
                        product_type = keyword
                        break
            if category:
                break

        # –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö, –ø—Ä–æ–±—É–µ–º –∏–∑–≤–ª–µ—á—å –ø–µ—Ä–≤–æ–µ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ
        if not product_type:
            words = name_lower.split()
            if words:
                product_type = words[0]

        return category, product_type

    @staticmethod
    def _extract_dimensions(name_lower: str) -> Dict[str, Any]:
        """–ò–∑–≤–ª–µ–∫–∞–µ—Ç —Ä–∞–∑–º–µ—Ä–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏"""
        dimensions = {
            'diameter': None,
            'thickness': None,
            'length': None,
            'width': None,
            'height': None,
            'number': None
        }

        # –ü–†–ò–û–†–ò–¢–ï–¢ 1: –¢–æ–ª—â–∏–Ω–∞ —Å —è–≤–Ω—ã–º —É–∫–∞–∑–∞–Ω–∏–µ–º (t=, s=, —Ç–æ–ª—â)
        thickness_explicit_patterns = [
            r't\s*=\s*(\d+\.?\d*)\s*–º–º',  # t=100–º–º
            r't\s*=\s*(\d+\.?\d*)',       # t=100
            r's\s*=\s*(\d+\.?\d*)',       # s=6
            r'—Ç–æ–ª—â[:\-]?\s*(\d+\.?\d*)',  # —Ç–æ–ª—â–∏–Ω–∞: 100
        ]
        for pattern in thickness_explicit_patterns:
            match = re.search(pattern, name_lower)
            if match:
                try:
                    dimensions['thickness'] = float(match.group(1))
                    break
                except:
                    pass

        # –ü–†–ò–û–†–ò–¢–ï–¢ 2: –î–∏–∞–º–µ—Ç—Ä —Å —è–≤–Ω—ã–º —É–∫–∞–∑–∞–Ω–∏–µ–º (√ò, —Ñ, d, –¥–∏–∞–º–µ—Ç—Ä)
        diameter_explicit_patterns = [
            r'[√∏—Ñ‚àÖ]\s*(\d+\.?\d*)',
            r'–¥–∏–∞–º–µ—Ç—Ä\s*[:\-]?\s*(\d+\.?\d*)',
            r'–¥—É\s*(\d+\.?\d*)',  # DN (–î–£)
            r'dn\s*(\d+\.?\d*)',  # DN
            r'–¥\.?\s*(\d+\.?\d*)',  # –¥.219
        ]
        for pattern in diameter_explicit_patterns:
            match = re.search(pattern, name_lower)
            if match:
                try:
                    dimensions['diameter'] = float(match.group(1))
                    break
                except:
                    pass

        # –ü–†–ò–û–†–ò–¢–ï–¢ 3: –†–∞–∑–º–µ—Ä—ã —á–µ—Ä–µ–∑ "—Ö" (–îx–®x–í)
        size_pattern = r'(\d+\.?\d*)\s*[x—Ö√ó]\s*(\d+\.?\d*)(?:\s*[x—Ö√ó]\s*(\d+\.?\d*))?'
        match = re.search(size_pattern, name_lower)
        if match:
            try:
                val1 = float(match.group(1))
                val2 = float(match.group(2))
                val3 = float(match.group(3)) if match.group(3) else None

                # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —á—Ç–æ —ç—Ç–æ: —Ç—Ä—É–±–∞ (–¥–∏–∞–º–µ—Ç—Ä —Ö —Ç–æ–ª—â–∏–Ω–∞) –∏–ª–∏ —Ä–∞–∑–º–µ—Ä—ã (–î—Ö–®—Ö–í)
                if '—Ç—Ä—É–±' in name_lower and val3 is None:
                    # –¢—Ä—É–±–∞: –ø–µ—Ä–≤–æ–µ - –¥–∏–∞–º–µ—Ç—Ä, –≤—Ç–æ—Ä–æ–µ - —Ç–æ–ª—â–∏–Ω–∞
                    if dimensions['diameter'] is None:
                        dimensions['diameter'] = val1
                    if dimensions['thickness'] is None:
                        dimensions['thickness'] = val2
                elif '—à–≤–µ–ª–ª–µ—Ä' in name_lower or '–¥–≤—É—Ç–∞–≤—Ä' in name_lower:
                    # –ü—Ä–æ—Ñ–∏–ª—å: –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º, –∏—Å–ø–æ–ª—å–∑—É–µ–º –Ω–æ–º–µ—Ä
                    pass
                else:
                    # –û–±—ã—á–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã
                    dimensions['length'] = val1
                    dimensions['width'] = val2
                    if val3:
                        dimensions['height'] = val3
            except:
                pass

        # –ü–†–ò–û–†–ò–¢–ï–¢ 4: –û–¥–∏–Ω–æ—á–Ω–æ–µ —á–∏—Å–ª–æ —Å "–º–º"
        if (dimensions['diameter'] is None and
                dimensions['thickness'] is None and
                dimensions['length'] is None):

            single_mm_pattern = r'(\d+\.?\d*)\s*–º–º'
            match = re.search(single_mm_pattern, name_lower)
            if match:
                try:
                    val = float(match.group(1))

                    # –ï—Å–ª–∏ –µ—Å—Ç—å —Å–ª–æ–≤–∞ —Ç–∏–ø–∞ "—Ç–æ–ª—â", "—Ç–æ–ª—Å—Ç" - —ç—Ç–æ —Ç–æ–ª—â–∏–Ω–∞
                    if re.search(r'—Ç–æ–ª—â|—Ç–æ–ª—Å—Ç', name_lower):
                        dimensions['thickness'] = val
                    # –ï—Å–ª–∏ –µ—Å—Ç—å "–¥–∏–∞–º" - —ç—Ç–æ –¥–∏–∞–º–µ—Ç—Ä
                    elif re.search(r'–¥–∏–∞–º|√∏|—Ñ|–¥—É|dn', name_lower):
                        dimensions['diameter'] = val
                    # –ò–Ω–∞—á–µ —Å—á–∏—Ç–∞–µ–º –¥–∏–∞–º–µ—Ç—Ä–æ–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                    else:
                        dimensions['diameter'] = val
                except:
                    pass

        # –ù–æ–º–µ—Ä (–¥–ª—è –ø—Ä–æ—Ñ–∏–ª–µ–π —Ç–∏–ø–∞ —à–≤–µ–ª–ª–µ—Ä, –¥–≤—É—Ç–∞–≤—Ä)
        number_patterns = [
            r'[‚Ññ#]\s*(\d+\.?\d*)',
            r'(?:—à–≤–µ–ª–ª–µ—Ä|–¥–≤—É—Ç–∞–≤—Ä|—É–≥–æ–ª–æ–∫)\s+(\d+\.?\d*)',
            r'\s(\d+\.?\d*)[—É–ø–∞–£–ü–ê]'
        ]
        for pattern in number_patterns:
            match = re.search(pattern, name_lower)
            if match:
                try:
                    dimensions['number'] = float(match.group(1))
                    break
                except:
                    pass

        return dimensions

    @staticmethod
    def _extract_material(name_lower: str) -> Optional[str]:
        """–ò–∑–≤–ª–µ–∫–∞–µ—Ç –º–∞—Ç–µ—Ä–∏–∞–ª"""
        materials = [
            '—Å—Ç3', '—Å—Ç20', '—Å—Ç35', '—Å—Ç45', '—Å—Ç40—Ö',
            '—Å245', '—Å255', '—Å275', '—Å345',
            '09–≥2—Å', '10—Ö—Å–Ω–¥', '15—Ö—Å–Ω–¥',
            '–æ—Ü–∏–Ω–∫', '–æ—Ü–∏–Ω–∫–æ–≤–∞–Ω–Ω—ã–π', '–æ—Ü–∏–Ω–∫–æ–≤–∞–Ω–Ω–∞—è',
            '–Ω–µ—Ä–∂–∞–≤–µ–π–∫–∞', '–Ω–µ—Ä–∂–∞–≤–µ—é—â–∏–π', '–Ω–µ—Ä–∂–∞–≤–µ—é—â–∞—è',
            '–∞–ª—é–º–∏–Ω–∏–π', '–∞–ª—é–º–∏–Ω–∏–µ–≤—ã–π', '–∞–ª—é–º–∏–Ω–∏–µ–≤–∞—è',
            '–º–µ–¥—å', '–º–µ–¥–Ω—ã–π', '–º–µ–¥–Ω–∞—è',
            '–ø–≤—Ö', '–ø–Ω–¥', '–ø–ø', '–ø—ç', '–ø–æ–ª–∏—ç—Ç–∏–ª–µ–Ω', '–ø–æ–ª–∏–ø—Ä–æ–ø–∏–ª–µ–Ω', '–ø–ø—Ä',
            '—Ä–µ–∑–∏–Ω–∞', '—Ä–µ–∑–∏–Ω–æ–≤—ã–π', '—Ä–µ–∑–∏–Ω–æ–≤–∞—è',
            '–±–µ—Ç–æ–Ω', '–∂–µ–ª–µ–∑–æ–±–µ—Ç–æ–Ω', '–∂/–±', '–∂–±–∏',
            '–¥–µ—Ä–µ–≤–æ', '–¥–µ—Ä–µ–≤—è–Ω–Ω—ã–π', '–¥–µ—Ä–µ–≤—è–Ω–Ω–∞—è',
            '–ø–ª–∞—Å—Ç–∏–∫', '–ø–ª–∞—Å—Ç–∏–∫–æ–≤—ã–π', '–ø–ª–∞—Å—Ç–∏–∫–æ–≤–∞—è',
            '—Ç–µ–∫—Å—Ç–∏–ª—å–Ω', '–∫–∞–Ω–∞—Ç', '–≤–µ—Ä–µ–≤–∫'
        ]

        for material in materials:
            if material in name_lower:
                return material

        return None

    @staticmethod
    def _extract_gost(name_lower: str) -> Optional[str]:
        """–ò–∑–≤–ª–µ–∫–∞–µ—Ç –ì–û–°–¢/–¢–£/–û–°–¢"""
        patterns = [
            r'–≥–æ—Å—Ç\s*[\s\-]?\s*[\d\-\.]+',
            r'—Ç—É\s*[\s\-]?\s*[\d\-\.]+',
            r'–æ—Å—Ç\s*[\s\-]?\s*[\d\-\.]+',
            r'—Å—Ç–æ\s*[\s\-]?\s*[\d\-\.]+',
            r'din\s*[\s\-]?\s*[\d\-\.]+',
            r'iso\s*[\s\-]?\s*[\d\-\.]+',
        ]

        for pattern in patterns:
            match = re.search(pattern, name_lower)
            if match:
                return match.group(0).strip()

        return None

    @staticmethod
    def _extract_model(name_lower: str) -> Optional[str]:
        """–ò–∑–≤–ª–µ–∫–∞–µ—Ç –º–æ–¥–µ–ª—å/–∞—Ä—Ç–∏–∫—É–ª"""
        patterns = [
            r'ral\s*\d+',
            r'—Å–µ—Ä–∏—è\s*[\d\-\.]+',
            r'—Ç–∏–ø\s*[\w\-]+',
            r'–º–æ–¥–µ–ª—å\s*[\w\-]+',
            r'–∞—Ä—Ç\.?\s*[\w\-]+',
            r'[–∞-—èa-z]+\-\d+',  # —Ç–∏–ø–∞ –°–¢–ü-10
        ]

        for pattern in patterns:
            match = re.search(pattern, name_lower)
            if match:
                return match.group(0).strip()

        return None

    @staticmethod
    def _extract_brand(name_lower: str) -> Optional[str]:
        """–ò–∑–≤–ª–µ–∫–∞–µ—Ç –±—Ä–µ–Ω–¥"""
        brands = [
            'bosch', 'makita', 'dewalt', 'hitachi', 'metabo', 'milwaukee',
            'legrand', 'schneider', 'abb', 'iek',
            'knauf', 'ceresit', 'henkel', 'sika',
            'grohe', 'hansgrohe', 'ideal standard', 'valtec',
            '—Ä–µ—Å–∞–Ω—Ç–∞', '—Å–≤–∞—Ä–æ–≥', 'jasic', 'esab', '–ø–∞—Ç–æ–Ω',
            'graco', 'wagner', 'kronen', 'yato',
            '–∑—É–±—Ä', 'matrix', 'sturm', 'force'
        ]

        for brand in brands:
            if brand in name_lower:
                return brand

        return None

    @staticmethod
    def _extract_all_measurements(name_lower: str) -> Dict[str, List[float]]:
        """–ò–∑–≤–ª–µ–∫–∞–µ—Ç –≤—Å–µ —á–∏—Å–ª–æ–≤—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è —Å –µ–¥–∏–Ω–∏—Ü–∞–º–∏"""
        measurements = {}

        # –ò—â–µ–º –≤—Å–µ —á–∏—Å–ª–∞ —Å –µ–¥–∏–Ω–∏—Ü–∞–º–∏ –∏–∑–º–µ—Ä–µ–Ω–∏—è
        for unit_type, units in ProductMatcher.UNITS.items():
            for unit in units:
                pattern = rf'(\d+\.?\d*)\s*{re.escape(unit)}'
                matches = re.findall(pattern, name_lower)
                if matches:
                    measurements[unit_type] = [float(m) for m in matches]

        return measurements

    @staticmethod
    def _extract_specifications(name_lower: str) -> List[str]:
        """–ò–∑–≤–ª–µ–∫–∞–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–∫–ª–∞—Å—Å—ã, —Ç–∏–ø—ã, —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã)"""
        specifications = []

        # IP –∫–ª–∞—Å—Å
        ip_match = re.search(r'ip\s*\d+', name_lower)
        if ip_match:
            specifications.append(ip_match.group(0))

        # PN (–¥–∞–≤–ª–µ–Ω–∏–µ)
        pn_match = re.search(r'pn\s*\d+', name_lower)
        if pn_match:
            specifications.append(pn_match.group(0))

        # DN (–¥–∏–∞–º–µ—Ç—Ä –Ω–æ–º–∏–Ω–∞–ª—å–Ω—ã–π)
        dn_match = re.search(r'dn\s*\d+', name_lower)
        if dn_match:
            specifications.append(dn_match.group(0))

        # –ö–ª–∞—Å—Å —Ç–æ—á–Ω–æ—Å—Ç–∏/–ø—Ä–æ—á–Ω–æ—Å—Ç–∏
        class_match = re.search(r'–∫–ª\.?[\s\-]?\w+', name_lower)
        if class_match:
            specifications.append(class_match.group(0))

        return specifications

    @staticmethod
    def calculate_similarity(name1: str, name2: str) -> float:
        """
        –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Å—Ö–æ–∂–µ—Å—Ç—å –º–µ–∂–¥—É –¥–≤—É–º—è —Ç–æ–≤–∞—Ä–∞–º–∏

        –í–ï–†–°–ò–Ø 3.0 - –£–õ–£–ß–®–ï–ù–ù–´–ô –ê–õ–ì–û–†–ò–¢–ú –° –ü–†–û–í–ï–†–ö–û–ô –ö–†–ò–¢–ò–ß–ù–´–• –ü–ê–†–ê–ú–ï–¢–†–û–í:
        - –£—á–∏—Ç—ã–≤–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏ —Ç–∏–ø
        - –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä—ã —Å –¥–æ–ø—É—Å–∫–æ–º
        - –ù–û–í–û–ï: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–≥—Ä—É–∑–æ–ø–æ–¥—ä–µ–º–Ω–æ—Å—Ç—å, –¥–ª–∏–Ω—É, –¥–∏–∞–º–µ—Ç—Ä, —Å–µ—á–µ–Ω–∏–µ)
        - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –º–∞—Ç–µ—Ä–∏–∞–ª –∏ –ì–û–°–¢
        - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–∑–≤–µ—à–µ–Ω–Ω—É—é —Å—É–º–º—É —Ñ–∞–∫—Ç–æ—Ä–æ–≤

        Args:
            name1: –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
            name2: –Ω–∞–∑–≤–∞–Ω–∏–µ –≤—Ç–æ—Ä–æ–≥–æ —Ç–æ–≤–∞—Ä–∞

        Returns:
            float: –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Å—Ö–æ–∂–µ—Å—Ç–∏ (0-1)
        """
        name1_lower = name1.lower()
        name2_lower = name2.lower()

        # –ö–†–ò–¢–ò–ß–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê: –ï—Å–ª–∏ –µ—Å—Ç—å —è–≤–Ω—ã–µ —Ä–∞–∑–ª–∏—á–∏—è –≤ –∫–ª—é—á–µ–≤—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö - —Å—Ä–∞–∑—É –Ω–∏–∑–∫–∞—è —Å—Ö–æ–∂–µ—Å—Ç—å
        critical_penalty = ProductMatcher._check_critical_parameters(name1_lower, name2_lower)
        if critical_penalty < 0.5:
            # –ï—Å—Ç—å –∫—Ä–∏—Ç–∏—á–Ω—ã–µ —Ä–∞–∑–ª–∏—á–∏—è - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –Ω–∏–∑–∫—É—é —Å—Ö–æ–∂–µ—Å—Ç—å
            return critical_penalty

        # –ò–∑–≤–ª–µ–∫–∞–µ–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
        features1 = ProductMatcher.extract_key_features(name1)
        features2 = ProductMatcher.extract_key_features(name2)

        # –ë–∞–∑–æ–≤–∞—è —Å—Ö–æ–∂–µ—Å—Ç—å —Å—Ç—Ä–æ–∫ (—Å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–µ–π)
        normalized1 = ProductMatcher._normalize_string(name1)
        normalized2 = ProductMatcher._normalize_string(name2)
        string_similarity = SequenceMatcher(None, normalized1, normalized2).ratio()

        # –§–∞–∫—Ç–æ—Ä—ã —Å—Ö–æ–∂–µ—Å—Ç–∏
        factors = {}

        # 1. –ö–∞—Ç–µ–≥–æ—Ä–∏—è (–≤–µ—Å 25%)
        if features1['category'] == features2['category'] and features1['category'] is not None:
            factors['category'] = 1.0
        else:
            factors['category'] = 0.0

        # 2. –¢–∏–ø —Ç–æ–≤–∞—Ä–∞ (–≤–µ—Å 25%)
        if features1['type'] == features2['type'] and features1['type'] is not None:
            factors['type'] = 1.0
        elif features1['type'] and features2['type']:
            # –ß–∞—Å—Ç–∏—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Ç–∏–ø–∞
            type_sim = SequenceMatcher(None, features1['type'], features2['type']).ratio()
            factors['type'] = type_sim
        else:
            factors['type'] = 0.0

        # 3. –†–∞–∑–º–µ—Ä—ã (–≤–µ—Å 20%)
        size_sim = ProductMatcher._compare_dimensions(features1, features2)
        factors['size'] = size_sim

        # 4. –ú–∞—Ç–µ—Ä–∏–∞–ª (–≤–µ—Å 10%)
        if features1['material'] and features2['material']:
            if features1['material'] == features2['material']:
                factors['material'] = 1.0
            else:
                factors['material'] = 0.5  # –†–∞–∑–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã, –Ω–æ –æ–±–∞ —É–∫–∞–∑–∞–Ω—ã
        else:
            factors['material'] = 0.7  # –ú–∞—Ç–µ—Ä–∏–∞–ª –Ω–µ —É–∫–∞–∑–∞–Ω - –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ

        # 5. –ì–û–°–¢ (–≤–µ—Å 10%)
        if features1['gost'] and features2['gost']:
            if features1['gost'] == features2['gost']:
                factors['gost'] = 1.0
            else:
                factors['gost'] = 0.3  # –†–∞–∑–Ω—ã–µ –ì–û–°–¢—ã - –Ω–∏–∑–∫–∞—è —Å—Ö–æ–∂–µ—Å—Ç—å
        else:
            factors['gost'] = 0.7  # –ì–û–°–¢ –Ω–µ —É–∫–∞–∑–∞–Ω - –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ

        # 6. –ë–∞–∑–æ–≤–∞—è —Å—Ö–æ–∂–µ—Å—Ç—å —Å—Ç—Ä–æ–∫ (–≤–µ—Å 10%)
        factors['string'] = string_similarity

        # –í–∑–≤–µ—à–µ–Ω–Ω–∞—è —Å—É–º–º–∞
        weights = {
            'category': 0.25,
            'type': 0.25,
            'size': 0.20,
            'material': 0.10,
            'gost': 0.10,
            'string': 0.10
        }

        total_similarity = sum(factors[key] * weights[key] for key in weights.keys())

        # –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞: –µ—Å–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ä–∞–∑–Ω—ã–µ - —Å–∏–ª—å–Ω–æ —Å–Ω–∏–∂–∞–µ–º —Å—Ö–æ–∂–µ—Å—Ç—å
        if factors['category'] == 0.0 and features1['category'] and features2['category']:
            total_similarity *= 0.6  # –°–Ω–∏–∂–∞–µ–º –Ω–∞ 40%

        # –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞: –µ—Å–ª–∏ —Ç–∏–ø—ã —Å–∏–ª—å–Ω–æ —Ä–∞–∑–Ω—ã–µ - —Ç–æ–∂–µ —Å–Ω–∏–∂–∞–µ–º
        if factors['type'] < 0.5:
            total_similarity *= 0.8  # –°–Ω–∏–∂–∞–µ–º –Ω–∞ 20%

        # –ü—Ä–∏–º–µ–Ω—è–µ–º —à—Ç—Ä–∞—Ñ –∑–∞ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
        total_similarity *= critical_penalty

        return min(1.0, total_similarity)

    @staticmethod
    def _check_critical_parameters(name1: str, name2: str) -> float:
        """
        –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–æ–≤–∞—Ä–æ–≤

        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç (0-1):
        - 1.0 = –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–æ–≤–ø–∞–¥–∞—é—Ç –∏–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω—ã
        - 0.3-0.7 = –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ
        - 0.0-0.3 = –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∏–ª—å–Ω–æ —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è (—ç—Ç–æ –†–ê–ó–ù–´–ï —Ç–æ–≤–∞—Ä—ã!)

        Returns:
            float: –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Å—Ö–æ–∂–µ—Å—Ç–∏ –ø–æ –∫—Ä–∏—Ç–∏—á–Ω—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º
        """
        import re

        penalty = 1.0  # –ù–∞—á–∏–Ω–∞–µ–º —Å 1.0 (–Ω–µ—Ç —à—Ç—Ä–∞—Ñ–∞)

        # 1. –†–£–õ–ï–¢–ö–ò - –ø—Ä–æ–≤–µ—Ä—è–µ–º –¥–ª–∏–Ω—É
        if '—Ä—É–ª–µ—Ç–∫–∞' in name1 and '—Ä—É–ª–µ—Ç–∫–∞' in name2:
            nums1 = re.findall(r'(\d+)\s*–º(?![–∞-—è—ë])', name1)
            nums2 = re.findall(r'(\d+)\s*–º(?![–∞-—è—ë])', name2)

            if nums1 and nums2:
                len1 = int(nums1[0])
                len2 = int(nums2[0])

                if len1 != len2:
                    # –†–∞–∑–Ω–∞—è –¥–ª–∏–Ω–∞ - —ç—Ç–æ –†–ê–ó–ù–´–ï —Ç–æ–≤–∞—Ä—ã!
                    ratio = min(len1, len2) / max(len1, len2)
                    penalty = min(penalty, 0.3 + ratio * 0.2)  # –ú–∞–∫—Å–∏–º—É–º 0.5

        # 2. –°–¢–†–û–ü–´ - –ø—Ä–æ–≤–µ—Ä—è–µ–º –≥—Ä—É–∑–æ–ø–æ–¥—ä–µ–º–Ω–æ—Å—Ç—å
        if '—Å—Ç—Ä–æ–ø' in name1 and '—Å—Ç—Ä–æ–ø' in name2:
            # –ò—â–µ–º –≥—Ä—É–∑–æ–ø–æ–¥—ä–µ–º–Ω–æ—Å—Ç—å: 2—Ç, 2,0—Ç, 2.5—Ç, –°–¢–ü 2,0, –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ "16—Ç–Ω", "2—Ç–Ω"
            nums1 = re.findall(r'(?:—Å—Ç–ø|—Å–∫–ø|—É—Åk|—Å—Ü–∫|—Å—Å–∫)\s*(\d+(?:[.,]\d+)?)', name1)
            if not nums1:
                # –ò—â–µ–º "16—Ç–Ω", "2—Ç–Ω", "10—Ç" –∏ —Ç.–¥. —Å —É—á–µ—Ç–æ–º "—Ç–Ω" –∏ "—Ç"
                nums1 = re.findall(r'(\d+(?:[.,]\d+)?)\s*(?:—Ç–Ω|—Ç)(?![–∞-—è])', name1, re.IGNORECASE)

            nums2 = re.findall(r'(?:—Å—Ç–ø|—Å–∫–ø|—É—Åk|—Å—Ü–∫|—Å—Å–∫)\s*(\d+(?:[.,]\d+)?)', name2)
            if not nums2:
                nums2 = re.findall(r'(\d+(?:[.,]\d+)?)\s*(?:—Ç–Ω|—Ç)(?![–∞-—è])', name2, re.IGNORECASE)

            if nums1 and nums2:
                t1 = float(nums1[0].replace(',', '.'))
                t2 = float(nums2[0].replace(',', '.'))

                diff = abs(t1 - t2)

                if diff > 0.5:  # –†–∞–∑–Ω–∏—Ü–∞ –±–æ–ª—å—à–µ 0.5—Ç
                    ratio = min(t1, t2) / max(t1, t2)
                    penalty = min(penalty, 0.35 + ratio * 0.25)  # –ú–∞–∫—Å–∏–º—É–º 0.6

        # 3. –¢–ê–õ–ò - –ø—Ä–æ–≤–µ—Ä—è–µ–º –≥—Ä—É–∑–æ–ø–æ–¥—ä–µ–º–Ω–æ—Å—Ç—å –ò –¥–ª–∏–Ω—É
        if '—Ç–∞–ª—å' in name1 and '—Ç–∞–ª—å' in name2:
            # –ì—Ä—É–∑–æ–ø–æ–¥—ä–µ–º–Ω–æ—Å—Ç—å: 5–¢, 5—Ç, 5–¢–ù, 5—Ç–Ω, 5,0 —Ç–Ω
            nums1 = re.findall(r'(\d+(?:[.,]\d+)?)\s*(?:—Ç–Ω|—Ç[—Öx]?)(?![–∞-—è])', name1, re.IGNORECASE)
            nums2 = re.findall(r'(\d+(?:[.,]\d+)?)\s*(?:—Ç–Ω|—Ç[—Öx]?)(?![–∞-—è])', name2, re.IGNORECASE)

            if nums1 and nums2:
                t1 = float(nums1[0].replace(',', '.'))
                t2 = float(nums2[0].replace(',', '.'))

                diff = abs(t1 - t2)

                if diff > 0.5:
                    ratio = min(t1, t2) / max(t1, t2)
                    penalty = min(penalty, 0.35 + ratio * 0.25)  # –ú–∞–∫—Å–∏–º—É–º 0.6

            # –î–ª–∏–Ω–∞: 3–ú, 12–º
            len1 = re.findall(r'(\d+)[–º–ú](?![–∞-—è–ê-–Ø])', name1)
            len2 = re.findall(r'(\d+)[–º–ú](?![–∞-—è–ê-–Ø])', name2)

            if len1 and len2:
                l1 = int(len1[0])
                l2 = int(len2[0])

                if abs(l1 - l2) > 1:  # –†–∞–∑–Ω–∏—Ü–∞ –±–æ–ª—å—à–µ 1 –º–µ—Ç—Ä–∞
                    ratio = min(l1, l2) / max(l1, l2)
                    penalty = min(penalty, 0.5 + ratio * 0.3)  # –ú–∞–∫—Å–∏–º—É–º 0.8

        # 4. –î–û–ú–ö–†–ê–¢–´ - –ø—Ä–æ–≤–µ—Ä—è–µ–º –¢–ò–ü, –≥—Ä—É–∑–æ–ø–æ–¥—ä–µ–º–Ω–æ—Å—Ç—å –∏ –ú–û–î–ï–õ–¨
        if '–¥–æ–º–∫—Ä–∞—Ç' in name1 and '–¥–æ–º–∫—Ä–∞—Ç' in name2:
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –¥–æ–º–∫—Ä–∞—Ç–∞
            type1 = None
            type2 = None

            # –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ (–æ—Ç –±–æ–ª–µ–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ–≥–æ –∫ –º–µ–Ω–µ–µ):
            # 1. –ü–Ω–µ–≤–º–æ–≥–∏–¥—Ä–∞–≤–ª–∏—á–µ—Å–∫–∏–π
            if '–ø–Ω–µ–≤–º–æ–≥–∏–¥—Ä–∞–≤–ª' in name1 or '–ø–Ω–µ–≤–º–æ-–≥–∏–¥—Ä–∞–≤–ª' in name1:
                type1 = '–ø–Ω–µ–≤–º–æ–≥–∏–¥—Ä–∞–≤–ª–∏—á–µ—Å–∫–∏–π'
            # 2. –ì–∏–¥—Ä–∞–≤–ª–∏—á–µ—Å–∫–∏–π
            elif '–≥–∏–¥—Ä–∞–≤–ª' in name1:
                type1 = '–≥–∏–¥—Ä–∞–≤–ª–∏—á–µ—Å–∫–∏–π'
            # 3. –†–µ–µ—á–Ω—ã–π
            elif '—Ä–µ–µ—á–Ω' in name1 or re.search(r'–¥—Ä[-\s]*\d', name1):
                type1 = '—Ä–µ–µ—á–Ω—ã–π'
            # 4. –ü–æ–¥–∫–∞—Ç–Ω–æ–π
            elif '–ø–æ–¥–∫–∞—Ç–Ω' in name1:
                type1 = '–ø–æ–¥–∫–∞—Ç–Ω–æ–π'
            # 5. –í–∏–Ω—Ç–æ–≤–æ–π
            elif '–≤–∏–Ω—Ç–æ–≤' in name1:
                type1 = '–≤–∏–Ω—Ç–æ–≤–æ–π'
            # 6. –ö–∞–±–µ–ª—å–Ω—ã–π
            elif '–∫–∞–±–µ–ª—å–Ω' in name1 or re.search(r'–¥–∫[–±–≥]?[-\s]*\d', name1):
                type1 = '–∫–∞–±–µ–ª—å–Ω—ã–π'
            # 7. –†–µ–∑—å–±–æ–≤–æ–π
            elif '—Ä–µ–∑—å–±–æ–≤' in name1:
                type1 = '—Ä–µ–∑—å–±–æ–≤–æ–π'
            # 8. –¢–µ–ø–ª–æ–≤–æ–∑–Ω—ã–π
            elif '—Ç–µ–ø–ª–æ–≤–æ–∑' in name1 or re.search(r'–¥—Ç[-\s]*\d', name1):
                type1 = '—Ç–µ–ø–ª–æ–≤–æ–∑–Ω—ã–π'

            # –¢–æ –∂–µ –¥–ª—è name2
            if '–ø–Ω–µ–≤–º–æ–≥–∏–¥—Ä–∞–≤–ª' in name2 or '–ø–Ω–µ–≤–º–æ-–≥–∏–¥—Ä–∞–≤–ª' in name2:
                type2 = '–ø–Ω–µ–≤–º–æ–≥–∏–¥—Ä–∞–≤–ª–∏—á–µ—Å–∫–∏–π'
            elif '–≥–∏–¥—Ä–∞–≤–ª' in name2:
                type2 = '–≥–∏–¥—Ä–∞–≤–ª–∏—á–µ—Å–∫–∏–π'
            elif '—Ä–µ–µ—á–Ω' in name2 or re.search(r'–¥—Ä[-\s]*\d', name2):
                type2 = '—Ä–µ–µ—á–Ω—ã–π'
            elif '–ø–æ–¥–∫–∞—Ç–Ω' in name2:
                type2 = '–ø–æ–¥–∫–∞—Ç–Ω–æ–π'
            elif '–≤–∏–Ω—Ç–æ–≤' in name2:
                type2 = '–≤–∏–Ω—Ç–æ–≤–æ–π'
            elif '–∫–∞–±–µ–ª—å–Ω' in name2 or re.search(r'–¥–∫[–±–≥]?[-\s]*\d', name2):
                type2 = '–∫–∞–±–µ–ª—å–Ω—ã–π'
            elif '—Ä–µ–∑—å–±–æ–≤' in name2:
                type2 = '—Ä–µ–∑—å–±–æ–≤–æ–π'
            elif '—Ç–µ–ø–ª–æ–≤–æ–∑' in name2 or re.search(r'–¥—Ç[-\s]*\d', name2):
                type2 = '—Ç–µ–ø–ª–æ–≤–æ–∑–Ω—ã–π'

            # –ï—Å–ª–∏ —Ç–∏–ø—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –∏ –†–ê–ó–ù–´–ï - —ç—Ç–æ –†–ê–ó–ù–´–ï —Ç–æ–≤–∞—Ä—ã!
            if type1 and type2 and type1 != type2:
                penalty = min(penalty, 0.30)  # –†–µ–µ—á–Ω—ã–π vs –≥–∏–¥—Ä–∞–≤–ª–∏—á–µ—Å–∫–∏–π = –†–ê–ó–ù–´–ï

            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≥—Ä—É–∑–æ–ø–æ–¥—ä–µ–º–Ω–æ—Å—Ç—å (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ç–∏–ø—ã –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∏–ª–∏ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã)
            if not type1 or not type2 or type1 == type2:
                nums1 = re.findall(r'(\d+)\s*(?:—Ç–Ω|—Ç)(?![–∞-—è])', name1, re.IGNORECASE)
                nums2 = re.findall(r'(\d+)\s*(?:—Ç–Ω|—Ç)(?![–∞-—è])', name2, re.IGNORECASE)

                if nums1 and nums2:
                    t1 = int(nums1[0])
                    t2 = int(nums2[0])
                    diff = abs(t1 - t2)

                    # –î–ª—è –¥–æ–º–∫—Ä–∞—Ç–æ–≤ - —Å—Ç—Ä–æ–≥–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ
                    if diff >= 10:  # –†–∞–∑–Ω–∏—Ü–∞ 10—Ç –∏ –±–æ–ª–µ–µ - –æ—á–µ–Ω—å —Ä–∞–∑–Ω—ã–µ
                        penalty = min(penalty, 0.2)
                    elif diff >= 5:  # –†–∞–∑–Ω–∏—Ü–∞ 5—Ç –∏ –±–æ–ª–µ–µ - —Ä–∞–∑–Ω—ã–µ
                        ratio = min(t1, t2) / max(t1, t2)
                        penalty = min(penalty, 0.3 + ratio * 0.2)  # –ú–∞–∫—Å–∏–º—É–º 0.5
                    elif diff > 0:  # –ù–µ–±–æ–ª—å—à–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ - —Å—Ä–µ–¥–Ω—è—è —Å—Ö–æ–∂–µ—Å—Ç—å
                        ratio = min(t1, t2) / max(t1, t2)
                        penalty = min(penalty, 0.6 + ratio * 0.2)  # –ú–∞–∫—Å–∏–º—É–º 0.8

            # –ù–û–í–û–ï: –ü—Ä–æ–≤–µ—Ä—è–µ–º –ú–û–î–ï–õ–¨/–ê–†–¢–ò–ö–£–õ (–µ—Å–ª–∏ —Ç–∏–ø –∏ –≥—Ä—É–∑–æ–ø–æ–¥—ä–µ–º–Ω–æ—Å—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ)
            # –ò–∑–≤–ª–µ–∫–∞–µ–º –º–æ–¥–µ–ª–∏: –î–†-5000, SJ5, HHYG-50B, –î–†-10000, –∏ —Ç.–¥.
            model1 = None
            model2 = None

            # –ü–∞—Ç—Ç–µ—Ä–Ω—ã –º–æ–¥–µ–ª–µ–π:
            # –î–†-5000, –î–†-10000, –î–ö–ë-10, –î–ö-5, –î–¢-40
            m1 = re.search(r'–¥[—Ä—Ç–∫][–±–≥]?[-\s]*\d+', name1, re.IGNORECASE)
            if m1:
                model1 = m1.group(0).upper().replace(' ', '-')

            # SJ5, HHYG-50B, HHYG-100B, –∏ –¥—Ä—É–≥–∏–µ –±—É–∫–≤–µ–Ω–Ω–æ-—Ü–∏—Ñ—Ä–æ–≤—ã–µ
            if not model1:
                m1 = re.search(r'\b([A-Z]{2,}[-]?\d+[A-Z]?)\b', name1, re.IGNORECASE)
                if m1:
                    model1 = m1.group(1).upper()

            # TOR (–±—Ä–µ–Ω–¥/–º–æ–¥–µ–ª—å)
            if not model1 and 'tor' in name1.lower():
                model1 = 'TOR'

            # –¢–æ –∂–µ –¥–ª—è name2
            m2 = re.search(r'–¥[—Ä—Ç–∫][–±–≥]?[-\s]*\d+', name2, re.IGNORECASE)
            if m2:
                model2 = m2.group(0).upper().replace(' ', '-')

            if not model2:
                m2 = re.search(r'\b([A-Z]{2,}[-]?\d+[A-Z]?)\b', name2, re.IGNORECASE)
                if m2:
                    model2 = m2.group(1).upper()

            if not model2 and 'tor' in name2.lower():
                model2 = 'TOR'

            # –ï—Å–ª–∏ –º–æ–¥–µ–ª–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –∏ –†–ê–ó–ù–´–ï - —Å–Ω–∏–∂–∞–µ–º —Å—Ö–æ–∂–µ—Å—Ç—å
            if model1 and model2 and model1 != model2:
                # –†–∞–∑–Ω—ã–µ –º–æ–¥–µ–ª–∏ –ø—Ä–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–º —Ç–∏–ø–µ –∏ –≥—Ä—É–∑–æ–ø–æ–¥—ä–µ–º–Ω–æ—Å—Ç–∏
                # –≠—Ç–æ –º–æ–≥—É—Ç –±—ã—Ç—å —Ä–∞–∑–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã —Å —Ä–∞–∑–Ω—ã–º–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏
                penalty = min(penalty, 0.70)  # –°–Ω–∏–∂–∞–µ–º –¥–æ 70% (–Ω–µ –¥—É–±–ª–∏–∫–∞—Ç—ã, –Ω–æ –ø–æ—Ö–æ–∂–∏)

        # 5. –õ–ï–ë–ï–î–ö–ò - –ø—Ä–æ–≤–µ—Ä—è–µ–º –≥—Ä—É–∑–æ–ø–æ–¥—ä–µ–º–Ω–æ—Å—Ç—å
        if '–ª–µ–±–µ–¥–∫–∞' in name1 and '–ª–µ–±–µ–¥–∫–∞' in name2:
            nums1 = re.findall(r'(\d+(?:[.,]\d+)?)\s*[—Ç–¢]', name1)
            nums2 = re.findall(r'(\d+(?:[.,]\d+)?)\s*[—Ç–¢]', name2)

            if nums1 and nums2:
                t1 = float(nums1[0].replace(',', '.'))
                t2 = float(nums2[0].replace(',', '.'))

                if abs(t1 - t2) > 0.5:
                    ratio = min(t1, t2) / max(t1, t2)
                    penalty = min(penalty, 0.4 + ratio * 0.3)

        # 6. –ö–ê–ë–ï–õ–ò - –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å–µ—á–µ–Ω–∏–µ
        if '–∫–∞–±–µ–ª—å' in name1 and '–∫–∞–±–µ–ª—å' in name2:
            # –ò—â–µ–º —Å–µ—á–µ–Ω–∏–µ —Ç–∏–ø–∞ 3—Ö2.5
            nums1 = re.findall(r'(\d+)\s*—Ö\s*(\d+[.,]?\d*)', name1)
            nums2 = re.findall(r'(\d+)\s*—Ö\s*(\d+[.,]?\d*)', name2)

            if nums1 and nums2:
                # –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∂–∏–ª –∏ —Å–µ—á–µ–Ω–∏–µ
                if nums1[0] != nums2[0]:
                    penalty = min(penalty, 0.4)  # –†–∞–∑–Ω–æ–µ —Å–µ—á–µ–Ω–∏–µ - –æ—á–µ–Ω—å –Ω–∏–∑–∫–∞—è —Å—Ö–æ–∂–µ—Å—Ç—å

        # 7. –î–ò–°–ö–ò - –ø—Ä–æ–≤–µ—Ä—è–µ–º –¥–∏–∞–º–µ—Ç—Ä
        if '–¥–∏—Å–∫' in name1 and '–¥–∏—Å–∫' in name2:
            # –ò—â–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –¥–∏–∞–º–µ—Ç—Ä—ã 125, 180, 230 –∏ –¥—Ä—É–≥–∏–µ
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–æ—Ä–º–∞—Ç: 125—Ö..., d-180, √ò230, "180 –º–º"
            nums1 = re.findall(r'(?:^|[^\d])(\d{3})(?:—Ö|–º–º|$|[^\d])', name1)
            if not nums1:
                nums1 = re.findall(r'd[-\s]*(\d{3})', name1)
            if not nums1:
                nums1 = re.findall(r'[√∏√ò]\s*(\d{3})', name1)

            nums2 = re.findall(r'(?:^|[^\d])(\d{3})(?:—Ö|–º–º|$|[^\d])', name2)
            if not nums2:
                nums2 = re.findall(r'd[-\s]*(\d{3})', name2)
            if not nums2:
                nums2 = re.findall(r'[√∏√ò]\s*(\d{3})', name2)

            if nums1 and nums2 and nums1[0] != nums2[0]:
                d1 = int(nums1[0])
                d2 = int(nums2[0])
                # –î–ª—è –¥–∏—Å–∫–æ–≤ —Ä–∞–∑–Ω—ã–π –¥–∏–∞–º–µ—Ç—Ä - —ç—Ç–æ –û–ß–ï–ù–¨ –†–ê–ó–ù–´–ï —Ç–æ–≤–∞—Ä—ã
                ratio = min(d1, d2) / max(d1, d2)
                penalty = min(penalty, 0.2 + ratio * 0.2)  # –ú–∞–∫—Å–∏–º—É–º 0.4

        # 8. –≠–õ–ï–ö–¢–†–û–î–´ - –ø—Ä–æ–≤–µ—Ä—è–µ–º –¥–∏–∞–º–µ—Ç—Ä
        if '—ç–ª–µ–∫—Ç—Ä–æ–¥' in name1 and '—ç–ª–µ–∫—Ç—Ä–æ–¥' in name2:
            # –ò—â–µ–º –¥–∏–∞–º–µ—Ç—Ä: –¥-3, 3–º–º, –¥.3
            nums1 = re.findall(r'–¥[.-]?\s*(\d+)', name1)
            nums2 = re.findall(r'–¥[.-]?\s*(\d+)', name2)

            if not nums1:
                nums1 = re.findall(r'(\d+)\s*–º–º', name1)
            if not nums2:
                nums2 = re.findall(r'(\d+)\s*–º–º', name2)

            if nums1 and nums2 and nums1[0] != nums2[0]:
                # –†–∞–∑–Ω—ã–π –¥–∏–∞–º–µ—Ç—Ä —ç–ª–µ–∫—Ç—Ä–æ–¥–∞ - —ç—Ç–æ –†–ê–ó–ù–´–ï —Ç–æ–≤–∞—Ä—ã
                penalty = min(penalty, 0.3)

        # 9. –®–õ–ê–ù–ì–ò - –ø—Ä–æ–≤–µ—Ä—è–µ–º –¥–∏–∞–º–µ—Ç—Ä
        if '—à–ª–∞–Ω–≥' in name1 and '—à–ª–∞–Ω–≥' in name2:
            # –ò—â–µ–º –¥–∏–∞–º–µ—Ç—Ä
            nums1 = re.findall(r'd\s*(\d+)', name1)
            nums2 = re.findall(r'd\s*(\d+)', name2)

            if not nums1:
                nums1 = re.findall(r'(\d+)\s*–º–º', name1)
            if not nums2:
                nums2 = re.findall(r'(\d+)\s*–º–º', name2)

            if nums1 and nums2 and nums1[0] != nums2[0]:
                ratio = min(int(nums1[0]), int(nums2[0])) / max(int(nums1[0]), int(nums2[0]))
                penalty = min(penalty, 0.4 + ratio * 0.3)

        # 10. –ö–û–õ–¨–¶–ê –°–¢–ï–ù–û–í–´–ï - –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä—ã (–¥–∏–∞–º–µ—Ç—Ä –∏ –≤—ã—Å–æ—Ç—É)
        if '–∫–æ–ª—å—Ü–æ —Å—Ç–µ–Ω–æ–≤–æ–µ' in name1 and '–∫–æ–ª—å—Ü–æ —Å—Ç–µ–Ω–æ–≤–æ–µ' in name2:
            # –§–æ—Ä–º–∞—Ç: –ö–¶ 7-3, –ö–°-15-9, –≥–¥–µ –ø–µ—Ä–≤–æ–µ —á–∏—Å–ª–æ - –¥–∏–∞–º–µ—Ç—Ä, –≤—Ç–æ—Ä–æ–µ - –≤—ã—Å–æ—Ç–∞
            nums1 = re.findall(r'–∫[—Ü—Å][\s\-]*(\d+)[\s\-\.]+(\d+)', name1, re.IGNORECASE)
            nums2 = re.findall(r'–∫[—Ü—Å][\s\-]*(\d+)[\s\-\.]+(\d+)', name2, re.IGNORECASE)

            if nums1 and nums2:
                d1, h1 = int(nums1[0][0]), int(nums1[0][1])
                d2, h2 = int(nums2[0][0]), int(nums2[0][1])

                # –ï—Å–ª–∏ —Ä–∞–∑–º–µ—Ä—ã —Ä–∞–∑–Ω—ã–µ - —ç—Ç–æ –†–ê–ó–ù–´–ï —Ç–æ–≤–∞—Ä—ã!
                if d1 != d2 or h1 != h2:
                    # –û—á–µ–Ω—å –Ω–∏–∑–∫–∞—è —Å—Ö–æ–∂–µ—Å—Ç—å –¥–ª—è –∫–æ–ª–µ—Ü —Ä–∞–∑–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤
                    penalty = min(penalty, 0.25)

        # 11. –°–¢–†–û–ü–´ - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –î–õ–ò–ù–´ –ø—Ä–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π –≥—Ä—É–∑–æ–ø–æ–¥—ä–µ–º–Ω–æ—Å—Ç–∏
        if '—Å—Ç—Ä–æ–ø' in name1 and '—Å—Ç—Ä–æ–ø' in name2:
            # –ò—â–µ–º –¥–ª–∏–Ω—É: /3000, /6000, 6–ú, 10–º –∏ —Ç.–¥.
            l1_match = re.findall(r'/(\d+)', name1)
            if not l1_match:
                l1_match = re.findall(r'(\d+)[–º–ú](?![–∞-—è–ê-–Ø])', name1)

            l2_match = re.findall(r'/(\d+)', name2)
            if not l2_match:
                l2_match = re.findall(r'(\d+)[–º–ú](?![–∞-—è–ê-–Ø])', name2)

            if l1_match and l2_match:
                l1 = int(l1_match[0])
                l2 = int(l2_match[0])

                # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –¥–ª–∏–Ω—É (6000–º–º = 6–º)
                if l1 >= 1000:
                    l1 = l1 / 1000
                if l2 >= 1000:
                    l2 = l2 / 1000

                # –ï—Å–ª–∏ –¥–ª–∏–Ω–∞ —Å–∏–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è - —Å–Ω–∏–∂–∞–µ–º —Å—Ö–æ–∂–µ—Å—Ç—å
                if abs(l1 - l2) > 1:  # –†–∞–∑–Ω–∏—Ü–∞ –±–æ–ª—å—à–µ 1 –º–µ—Ç—Ä–∞
                    ratio = min(l1, l2) / max(l1, l2)
                    penalty = min(penalty, 0.5 + ratio * 0.3)  # –ú–∞–∫—Å–∏–º—É–º 0.8

        # 12. –°–¢–†–û–ü–´ - –ø—Ä–æ–≤–µ—Ä–∫–∞ –¢–ò–ü–ê (—Ç–µ–∫—Å—Ç–∏–ª—å–Ω—ã–π vs –∫–∞–Ω–∞—Ç–Ω—ã–π vs —Ü–µ–ø–Ω–æ–π)
        if '—Å—Ç—Ä–æ–ø' in name1 and '—Å—Ç—Ä–æ–ø' in name2:
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø —Å—Ç—Ä–æ–ø–∞
            type1 = None
            type2 = None

            # –¢–µ–∫—Å—Ç–∏–ª—å–Ω—ã–π: –¢–û–õ–¨–ö–û –°–¢–ü –∏–ª–∏ —è–≤–Ω–æ–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ "—Ç–µ–∫—Å—Ç–∏–ª—å–Ω"
            if '—Ç–µ–∫—Å—Ç–∏–ª—å–Ω' in name1 or re.search(r'—Å—Ç–ø(?![–∞-—è])', name1):
                type1 = '—Ç–µ–∫—Å—Ç–∏–ª—å–Ω—ã–π'
            # –ö–∞–Ω–∞—Ç–Ω—ã–π: –°–ö–ü (–°—Ç—Ä–æ–ø –ö–∞–Ω–∞—Ç–Ω—ã–π –ü–µ—Ç–ª–µ–≤–æ–π), –°–ö–ö, –∏–ª–∏ 4–°–ö, 2–°–ö –∏ —Ç.–¥., –∏–ª–∏ —è–≤–Ω–æ–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ "–∫–∞–Ω–∞—Ç–Ω"
            elif '–∫–∞–Ω–∞—Ç–Ω' in name1 or re.search(r'—Å[–∫–∫]–ø(?![–∞-—è])', name1) or re.search(r'—Å[–∫–∫][–∫–∫](?![–∞-—è])', name1) or re.search(r'\d+—Å[–∫–∫]', name1):
                type1 = '–∫–∞–Ω–∞—Ç–Ω—ã–π'
            # –¶–µ–ø–Ω–æ–π: –°–¶–ö, –∏–ª–∏ —è–≤–Ω–æ–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ "—Ü–µ–ø–Ω"
            elif '—Ü–µ–ø–Ω' in name1 or re.search(r'—Å—Ü–∫(?![–∞-—è])', name1):
                type1 = '—Ü–µ–ø–Ω–æ–π'

            if '—Ç–µ–∫—Å—Ç–∏–ª—å–Ω' in name2 or re.search(r'—Å—Ç–ø(?![–∞-—è])', name2):
                type2 = '—Ç–µ–∫—Å—Ç–∏–ª—å–Ω—ã–π'
            elif '–∫–∞–Ω–∞—Ç–Ω' in name2 or re.search(r'—Å[–∫–∫]–ø(?![–∞-—è])', name2) or re.search(r'—Å[–∫–∫][–∫–∫](?![–∞-—è])', name2) or re.search(r'\d+—Å[–∫–∫]', name2):
                type2 = '–∫–∞–Ω–∞—Ç–Ω—ã–π'
            elif '—Ü–µ–ø–Ω' in name2 or re.search(r'—Å—Ü–∫(?![–∞-—è])', name2):
                type2 = '—Ü–µ–ø–Ω–æ–π'

            # –ï—Å–ª–∏ —Ç–∏–ø—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –∏ —Ä–∞–∑–Ω—ã–µ - —ç—Ç–æ –†–ê–ó–ù–´–ï —Ç–æ–≤–∞—Ä—ã!
            if type1 and type2 and type1 != type2:
                penalty = min(penalty, 0.30)  # –û—á–µ–Ω—å –Ω–∏–∑–∫–∞—è —Å—Ö–æ–∂–µ—Å—Ç—å

        # 13. –°–í–ï–†–õ–ê - –ø—Ä–æ–≤–µ—Ä—è–µ–º –¥–∏–∞–º–µ—Ç—Ä
        if '—Å–≤–µ—Ä–ª–æ' in name1 and '—Å–≤–µ—Ä–ª–æ' in name2:
            nums1 = re.findall(r'(\d+(?:\.\d+)?)\s*–º–º', name1)
            nums2 = re.findall(r'(\d+(?:\.\d+)?)\s*–º–º', name2)

            if not nums1:
                nums1 = re.findall(r'd\s*(\d+(?:\.\d+)?)', name1)
            if not nums2:
                nums2 = re.findall(r'd\s*(\d+(?:\.\d+)?)', name2)

            if nums1 and nums2:
                d1 = float(nums1[0])
                d2 = float(nums2[0])

                if abs(d1 - d2) > 0.5:
                    ratio = min(d1, d2) / max(d1, d2)
                    penalty = min(penalty, 0.4 + ratio * 0.3)

        # 14. –®–í–ï–õ–õ–ï–† - –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–æ–º–µ—Ä
        if '—à–≤–µ–ª–ª–µ—Ä' in name1.lower() and '—à–≤–µ–ª–ª–µ—Ä' in name2.lower():
            # –ò—â–µ–º –Ω–æ–º–µ—Ä: "–®–≤–µ–ª–ª–µ—Ä 10", "–®–≤–µ–ª–ª–µ—Ä 20–£"
            num1 = re.search(r'—à–≤–µ–ª–ª–µ—Ä\s*(\d+\.?\d*)', name1.lower())
            num2 = re.search(r'—à–≤–µ–ª–ª–µ—Ä\s*(\d+\.?\d*)', name2.lower())

            if num1 and num2:
                n1 = float(num1.group(1))
                n2 = float(num2.group(1))

                # –ï—Å–ª–∏ –Ω–æ–º–µ—Ä–∞ —Ä–∞–∑–Ω—ã–µ - —ç—Ç–æ –†–ê–ó–ù–´–ï —Ç–æ–≤–∞—Ä—ã!
                if n1 != n2:
                    penalty = min(penalty, 0.30)  # –®–≤–µ–ª–ª–µ—Ä 10 vs 20 = –†–ê–ó–ù–´–ï

        # 15. –î–í–£–¢–ê–í–†/–ë–ê–õ–ö–ê - –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–æ–º–µ—Ä
        if ('–¥–≤—É—Ç–∞–≤—Ä' in name1.lower() or '–±–∞–ª–∫–∞' in name1.lower()) and \
                ('–¥–≤—É—Ç–∞–≤—Ä' in name2.lower() or '–±–∞–ª–∫–∞' in name2.lower()):
            # –ò—â–µ–º –Ω–æ–º–µ—Ä: "–î–≤—É—Ç–∞–≤—Ä 10", "–î–≤—É—Ç–∞–≤—Ä 20–ë1", "–ë–∞–ª–∫–∞ –¥–≤—É—Ç–∞–≤—Ä–æ–≤–∞—è 16"
            num1 = re.search(r'(?:–¥–≤—É—Ç–∞–≤—Ä|–±–∞–ª–∫–∞)\s*(?:–¥–≤—É—Ç–∞–≤—Ä–æ–≤–∞—è)?\s*(\d+\.?\d*)', name1.lower())
            num2 = re.search(r'(?:–¥–≤—É—Ç–∞–≤—Ä|–±–∞–ª–∫–∞)\s*(?:–¥–≤—É—Ç–∞–≤—Ä–æ–≤–∞—è)?\s*(\d+\.?\d*)', name2.lower())

            if num1 and num2:
                n1 = float(num1.group(1))
                n2 = float(num2.group(1))

                # –ï—Å–ª–∏ –Ω–æ–º–µ—Ä–∞ —Ä–∞–∑–Ω—ã–µ - —ç—Ç–æ –†–ê–ó–ù–´–ï —Ç–æ–≤–∞—Ä—ã!
                if n1 != n2:
                    penalty = min(penalty, 0.30)  # –î–≤—É—Ç–∞–≤—Ä 10 vs 20 = –†–ê–ó–ù–´–ï, –ë–∞–ª–∫–∞ 16 vs 30 = –†–ê–ó–ù–´–ï

        # 16. –ê–†–ú–ê–¢–£–†–ê - –ø—Ä–æ–≤–µ—Ä—è–µ–º –¥–∏–∞–º–µ—Ç—Ä –ò –∫–ª–∞—Å—Å
        if '–∞—Ä–º–∞—Ç—É—Ä–∞' in name1.lower() and '–∞—Ä–º–∞—Ç—É—Ä–∞' in name2.lower():
            # –î–∏–∞–º–µ—Ç—Ä: "–ê—Ä–º–∞—Ç—É—Ä–∞ 12", "—Ñ12", "–¥–∏–∞–º. 12 –º–º"
            d1 = re.search(r'(?:–∞—Ä–º–∞—Ç—É—Ä–∞|—Ñ|–¥–∏–∞–º\.?)\s*(\d+\.?\d*)', name1.lower())
            d2 = re.search(r'(?:–∞—Ä–º–∞—Ç—É—Ä–∞|—Ñ|–¥–∏–∞–º\.?)\s*(\d+\.?\d*)', name2.lower())

            if d1 and d2:
                diameter1 = float(d1.group(1))
                diameter2 = float(d2.group(1))

                # –ï—Å–ª–∏ –¥–∏–∞–º–µ—Ç—Ä —Ä–∞–∑–Ω—ã–π - —ç—Ç–æ –†–ê–ó–ù–´–ï —Ç–æ–≤–∞—Ä—ã!
                if abs(diameter1 - diameter2) >= 2:  # –†–∞–∑–Ω–∏—Ü–∞ 2–º–º –∏ –±–æ–ª–µ–µ
                    penalty = min(penalty, 0.30)  # –ê—Ä–º–∞—Ç—É—Ä–∞ 10–º–º vs 16–º–º = –†–ê–ó–ù–´–ï

            # –ö–ª–∞—Å—Å: "–ê500", "–ê3", "–ê-III", "–ê-I"
            k1 = re.search(r'–∞-?([ivxIVX\d]+)', name1.lower())
            k2 = re.search(r'–∞-?([ivxIVX\d]+)', name2.lower())

            if k1 and k2:
                # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º: –ê-III -> –ê3, –ê-I -> –ê1
                class1 = k1.group(1).upper().replace('III', '3').replace('II', '2').replace('I', '1').replace('V', '5')
                class2 = k2.group(1).upper().replace('III', '3').replace('II', '2').replace('I', '1').replace('V', '5')

                # –ï—Å–ª–∏ –∫–ª–∞—Å—Å —Ä–∞–∑–Ω—ã–π - —ç—Ç–æ –†–ê–ó–ù–´–ï —Ç–æ–≤–∞—Ä—ã!
                if class1 != class2:
                    penalty = min(penalty, 0.30)  # –ê1 vs –ê3 = –†–ê–ó–ù–´–ï

        # 17. –õ–ò–°–¢ - –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–ª—â–∏–Ω—É –∏ –º–∞—Ä–∫—É —Å—Ç–∞–ª–∏
        if '–ª–∏—Å—Ç' in name1.lower() and '–ª–∏—Å—Ç' in name2.lower():
            # –ò—â–µ–º —Ç–æ–ª—â–∏–Ω—É: "–õ–∏—Å—Ç 5", "–õ–∏—Å—Ç 12 –ì–û–°–¢", "–õ–∏—Å—Ç 16 –°345"
            # –ü–∞—Ç—Ç–µ—Ä–Ω—ã: "–õ–∏—Å—Ç 12", "–õ–∏—Å—Ç —Ä–∏—Ñ–ª–µ–Ω—ã–π 5—Ö1500—Ö6000", "–õ–∏—Å—Ç 6—Ö1500—Ö6000"

            # –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º –Ω–∞–π—Ç–∏ —Ç–æ–ª—â–∏–Ω—É –≤ —Ñ–æ—Ä–º–∞—Ç–µ "–ª–∏—Å—Ç —á–∏—Å–ª–æ"
            thick1 = re.search(r'–ª–∏—Å—Ç\s+(?:—Ä–∏—Ñ–ª–µ–Ω—ã–π\s+)?(\d+(?:[.,]\d+)?)', name1.lower())
            thick2 = re.search(r'–ª–∏—Å—Ç\s+(?:—Ä–∏—Ñ–ª–µ–Ω—ã–π\s+)?(\d+(?:[.,]\d+)?)', name2.lower())

            if thick1 and thick2:
                t1 = float(thick1.group(1).replace(',', '.'))
                t2 = float(thick2.group(1).replace(',', '.'))

                # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–ª—â–∏–Ω—ã (–ö–†–ò–¢–ò–ß–ù–û –¥–ª—è –ª–∏—Å—Ç–æ–≤!)
                # –î–∞–∂–µ 1–º–º —Ä–∞–∑–Ω–∏—Ü–∞ –∫—Ä–∏—Ç–∏—á–Ω–∞!
                if abs(t1 - t2) >= 1:  # –õ–∏—Å—Ç 5–º–º vs 6–º–º = –†–ê–ó–ù–´–ï
                    penalty = min(penalty, 0.30)

            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞—Ä–∫–∏ —Å—Ç–∞–ª–∏: –°—Ç3, –°245, –°345 –∏ —Ç.–¥.
            # –°—Ç3 vs –°245 = —Ä–∞–∑–Ω—ã–µ, –°245 vs –°345 = —Ä–∞–∑–Ω—ã–µ
            grade1 = None
            grade2 = None

            # –ò—â–µ–º: –°—Ç3, –°—Ç3—Å–ø5, –°245, –°345 –∏ —Ç.–¥.
            g1_match = re.search(r'(?:—Å—Ç|—Å)(\d+)', name1.lower())
            g2_match = re.search(r'(?:—Å—Ç|—Å)(\d+)', name2.lower())

            if g1_match:
                grade1 = int(g1_match.group(1))
            if g2_match:
                grade2 = int(g2_match.group(1))

            # –ï—Å–ª–∏ –º–∞—Ä–∫–∏ –Ω–∞–π–¥–µ–Ω—ã –∏ —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ
            if grade1 and grade2:
                # –°—Ç3 (3) vs –°345 (345) = –†–ê–ó–ù–´–ï
                # –°245 (245) vs –°345 (345) = –º–æ–≥—É—Ç –±—ã—Ç—å –¥–æ–ø—É—Å—Ç–∏–º—ã–º–∏, –Ω–æ –ª—É—á—à–µ —Å—á–∏—Ç–∞—Ç—å —Ä–∞–∑–Ω—ã–º–∏
                if abs(grade1 - grade2) > 50:  # –ë–æ–ª—å—à–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ –≤ –º–∞—Ä–∫–µ
                    penalty = min(penalty, 0.40)

        # 18. –¢–†–£–ë–ê - –ø—Ä–æ–≤–µ—Ä—è–µ–º –º–∞—Ç–µ—Ä–∏–∞–ª, –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ, –¥–∏–∞–º–µ—Ç—Ä, —Ç–æ–ª—â–∏–Ω—É –∏ SDR
        if '—Ç—Ä—É–±–∞' in name1.lower() and '—Ç—Ä—É–±–∞' in name2.lower():
            # –°–ù–ê–ß–ê–õ–ê –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ç—Ä—É–±—ã —Å –æ–¥–∏–Ω–æ—á–Ω—ã–º —á–∏—Å–ª–æ–º: "—Ç—Ä—É–±–∞ 159,4", "—Ç—Ä—É–±–∞ 219"
            # –≠—Ç–∏ —Ç—Ä—É–±—ã –º–æ–≥—É—Ç –Ω–µ –∏–º–µ—Ç—å —É–∫–∞–∑–∞–Ω–∏—è —Ç–æ–ª—â–∏–Ω—ã, —Ç–æ–ª—å–∫–æ –¥–∏–∞–º–µ—Ç—Ä
            single_dim1 = re.search(r'—Ç—Ä—É–±–∞\s+(\d+(?:[.,]\d+)?)', name1.lower())
            single_dim2 = re.search(r'—Ç—Ä—É–±–∞\s+(\d+(?:[.,]\d+)?)', name2.lower())

            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–∞–º–µ—Ç—Ä–∞ –∏ —Ç–æ–ª—â–∏–Ω—ã: 100—Ö5, 100*5, 100√ó5, 159—Ö8
            # –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º: —Ö (–ª–∞—Ç–∏–Ω—Å–∫–∞—è), * (–∑–≤–µ–∑–¥–æ—á–∫–∞), √ó (–∑–Ω–∞–∫ —É–º–Ω–æ–∂–µ–Ω–∏—è)
            dims1 = re.search(r'(\d+)\s*[—Ö*√óx]\s*(\d+(?:[.,]\d+)?)', name1.lower())
            dims2 = re.search(r'(\d+)\s*[—Ö*√óx]\s*(\d+(?:[.,]\d+)?)', name2.lower())

            # –ï—Å–ª–∏ –µ—Å—Ç—å —Ñ–æ—Ä–º–∞—Ç –¥–∏–∞–º–µ—Ç—Ä√ó—Ç–æ–ª—â–∏–Ω–∞
            if dims1 and dims2:
                d1 = float(dims1.group(1))
                t1 = float(dims1.group(2).replace(',', '.'))
                d2 = float(dims2.group(1))
                t2 = float(dims2.group(2).replace(',', '.'))

                # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–∞–º–µ—Ç—Ä–∞ (–ö–†–ò–¢–ò–ß–ù–û!)
                # –î–∞–∂–µ 5–º–º —Ä–∞–∑–Ω–∏—Ü–∞ –∫—Ä–∏—Ç–∏—á–Ω–∞ –¥–ª—è —Ç—Ä—É–±!
                if abs(d1 - d2) >= 5:  # –¢—Ä—É–±–∞ 108 vs 114 (—Ä–∞–∑–Ω–∏—Ü–∞ 6–º–º) = –†–ê–ó–ù–´–ï
                    penalty = min(penalty, 0.30)

                # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–ª—â–∏–Ω—ã —Å—Ç–µ–Ω–∫–∏
                # –î–ª—è —Å—Ç–∞–ª—å–Ω—ã—Ö —Ç—Ä—É–± - —Å—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (–¥–∞–∂–µ 1–º–º –∫—Ä–∏—Ç–∏—á–Ω–∞!)
                is_steel1 = '—Å—Ç–∞–ª—å' in name1.lower() or '–≥–æ—Å—Ç' in name1.lower() or '—Å—Ç2' in name1.lower() or '—Å—Ç3' in name1.lower()
                is_steel2 = '—Å—Ç–∞–ª—å' in name2.lower() or '–≥–æ—Å—Ç' in name2.lower() or '—Å—Ç2' in name2.lower() or '—Å—Ç3' in name2.lower()

                if is_steel1 and is_steel2:
                    # –î–ª—è —Å—Ç–∞–ª—å–Ω—ã—Ö —Ç—Ä—É–± - —Ç–æ–ª—â–∏–Ω–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Ç–æ—á–Ω–æ –∏–ª–∏ —Ä–∞–∑–ª–∏—á–∞—Ç—å—Å—è –Ω–µ –±–æ–ª–µ–µ —á–µ–º –Ω–∞ 1–º–º
                    if abs(t1 - t2) >= 1:  # 377√ó6 vs 377√ó5 = –†–ê–ó–ù–´–ï
                        penalty = min(penalty, 0.30)
                else:
                    # –î–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Ç—Ä—É–± (–ü–í–•, –ü–ù–î –∏ —Ç.–¥.) - —Ä–∞–∑–Ω–∏—Ü–∞ >2–º–º
                    if abs(t1 - t2) > 2:  # –†–∞–∑–Ω–∏—Ü–∞ –±–æ–ª—å—à–µ 2–º–º
                        penalty = min(penalty, 0.40)  # –¢—Ä—É–±–∞ —Ö5 vs —Ö8 = —Ä–∞–∑–Ω—ã–µ

            # –ï—Å–ª–∏ —Ñ–æ—Ä–º–∞—Ç–∞ –¥–∏–∞–º–µ—Ç—Ä√ó—Ç–æ–ª—â–∏–Ω–∞ –ù–ï–¢, –Ω–æ –µ—Å—Ç—å –æ–¥–∏–Ω–æ—á–Ω–æ–µ —á–∏—Å–ª–æ (—Ç–æ–ª—å–∫–æ –¥–∏–∞–º–µ—Ç—Ä)
            elif single_dim1 and single_dim2:
                d1 = float(single_dim1.group(1).replace(',', '.'))
                d2 = float(single_dim2.group(1).replace(',', '.'))

                # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–ª—å–∫–æ –¥–∏–∞–º–µ—Ç—Ä (—Ç–æ–ª—â–∏–Ω–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞)
                if abs(d1 - d2) >= 5:  # –¢—Ä—É–±–∞ 159,4 vs 219 = –†–ê–ó–ù–´–ï
                    penalty = min(penalty, 0.30)

            # –ò–ª–∏ –æ–¥–Ω–∞ —Ç—Ä—É–±–∞ —Å —Ñ–æ—Ä–º–∞—Ç–æ–º √ó, –¥—Ä—É–≥–∞—è –±–µ–∑
            elif (dims1 and single_dim2 and not dims2) or (dims2 and single_dim1 and not dims1):
                # –û–¥–Ω–∞ —Ç—Ä—É–±–∞: "108—Ö4", –¥—Ä—É–≥–∞—è: "114" (–±–µ–∑ —Ç–æ–ª—â–∏–Ω—ã)
                # –ò–∑–≤–ª–µ–∫–∞–µ–º –¥–∏–∞–º–µ—Ç—Ä—ã
                d1 = float(dims1.group(1)) if dims1 else float(single_dim1.group(1).replace(',', '.'))
                d2 = float(dims2.group(1)) if dims2 else float(single_dim2.group(1).replace(',', '.'))

                # –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –¥–∏–∞–º–µ—Ç—Ä—ã
                if abs(d1 - d2) >= 5:
                    penalty = min(penalty, 0.30)

            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–∞
            material1 = None
            material2 = None

            # –ü–ù–î/–ü–≠/HDPE/PE80/PE100 (–ø–æ–ª–∏—ç—Ç–∏–ª–µ–Ω)
            if '–ø–Ω–¥' in name1.lower() or '–ø—ç' in name1.lower() or '–ø–æ–ª–∏—ç—Ç–∏–ª–µ–Ω' in name1.lower() or 'hdpe' in name1.lower() or re.search(r'pe\s*\d+', name1.lower()):
                material1 = '–ø–æ–ª–∏—ç—Ç–∏–ª–µ–Ω'
            # –ü–ü–†/PPR/PP-R (–ø–æ–ª–∏–ø—Ä–æ–ø–∏–ª–µ–Ω)
            elif '–ø–ø—Ä' in name1.lower() or '–ø–æ–ª–∏–ø—Ä–æ–ø–∏–ª–µ–Ω' in name1.lower() or 'pp-r' in name1.lower() or 'ppr' in name1.lower():
                material1 = '–ø–æ–ª–∏–ø—Ä–æ–ø–∏–ª–µ–Ω'
            # –ü–í–•/PVC
            elif '–ø–≤—Ö' in name1.lower() or '–ø–æ–ª–∏–≤–∏–Ω–∏–ª—Ö–ª–æ—Ä–∏–¥' in name1.lower() or 'pvc' in name1.lower():
                material1 = '–ø–≤—Ö'
            # PEX (—Å—à–∏—Ç—ã–π –ø–æ–ª–∏—ç—Ç–∏–ª–µ–Ω)
            elif 'pex' in name1.lower() or '—Å—à–∏—Ç' in name1.lower():
                material1 = 'pex'
            # –ú–µ–¥–Ω–∞—è
            elif '–º–µ–¥–Ω' in name1.lower():
                material1 = '–º–µ–¥—å'
            # –°—Ç–∞–ª—å–Ω–∞—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –µ—Å–ª–∏ –µ—Å—Ç—å –ì–û–°–¢ –∏–ª–∏ "—Å—Ç–∞–ª—å–Ω–∞—è")
            elif '—Å—Ç–∞–ª—å' in name1.lower() or '–≥–æ—Å—Ç' in name1.lower() or re.search(r'\d+—Ö\d+', name1):
                material1 = '—Å—Ç–∞–ª—å'

            # –¢–æ –∂–µ –¥–ª—è name2
            if '–ø–Ω–¥' in name2.lower() or '–ø—ç' in name2.lower() or '–ø–æ–ª–∏—ç—Ç–∏–ª–µ–Ω' in name2.lower() or 'hdpe' in name2.lower() or re.search(r'pe\s*\d+', name2.lower()):
                material2 = '–ø–æ–ª–∏—ç—Ç–∏–ª–µ–Ω'
            elif '–ø–ø—Ä' in name2.lower() or '–ø–æ–ª–∏–ø—Ä–æ–ø–∏–ª–µ–Ω' in name2.lower() or 'pp-r' in name2.lower() or 'ppr' in name2.lower():
                material2 = '–ø–æ–ª–∏–ø—Ä–æ–ø–∏–ª–µ–Ω'
            elif '–ø–≤—Ö' in name2.lower() or '–ø–æ–ª–∏–≤–∏–Ω–∏–ª—Ö–ª–æ—Ä–∏–¥' in name2.lower() or 'pvc' in name2.lower():
                material2 = '–ø–≤—Ö'
            elif 'pex' in name2.lower() or '—Å—à–∏—Ç' in name2.lower():
                material2 = 'pex'
            elif '–º–µ–¥–Ω' in name2.lower():
                material2 = '–º–µ–¥—å'
            elif '—Å—Ç–∞–ª—å' in name2.lower() or '–≥–æ—Å—Ç' in name2.lower() or re.search(r'\d+—Ö\d+', name2):
                material2 = '—Å—Ç–∞–ª—å'

            # –ï—Å–ª–∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –∏ —Ä–∞–∑–Ω—ã–µ - —ç—Ç–æ –†–ê–ó–ù–´–ï —Ç–æ–≤–∞—Ä—ã!
            if material1 and material2 and material1 != material2:
                penalty = min(penalty, 0.30)  # –¢—Ä—É–±–∞ —Å—Ç–∞–ª—å–Ω–∞—è vs –ü–≠ = –†–ê–ó–ù–´–ï

            # –ù–û–í–û–ï: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ù–ê–ó–ù–ê–ß–ï–ù–ò–Ø (–•–í–° vs –ì–í–° vs –ö–∞–Ω–∞–ª–∏–∑–∞—Ü–∏—è)
            purpose1 = None
            purpose2 = None

            # –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –∫–∞–Ω–∞–ª–∏–∑–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å—Å—è –ø–µ—Ä–≤–æ–π
            # –ö–∞–Ω–∞–ª–∏–∑–∞—Ü–∏—è
            if '–∫–∞–Ω–∞–ª–∏–∑' in name1.lower():
                purpose1 = '–∫–∞–Ω–∞–ª–∏–∑–∞—Ü–∏—è'
            # –•–æ–ª–æ–¥–Ω–∞—è –≤–æ–¥–∞
            elif '—Ö–≤—Å' in name1.lower() or '—Ö–æ–ª–æ–¥–Ω' in name1.lower() or '–¥–ª—è –≤–æ–¥—ã' in name1.lower():
                purpose1 = '—Ö–≤—Å'
            # –ì–æ—Ä—è—á–∞—è –≤–æ–¥–∞
            elif '–≥–≤—Å' in name1.lower() or '–≥–æ—Ä—è—á' in name1.lower():
                purpose1 = '–≥–≤—Å'
            # –û—Ç–æ–ø–ª–µ–Ω–∏–µ
            elif '–æ—Ç–æ–ø–ª–µ–Ω' in name1.lower():
                purpose1 = '–æ—Ç–æ–ø–ª–µ–Ω–∏–µ'
            # –ì–∞–∑
            elif '–≥–∞–∑' in name1.lower():
                purpose1 = '–≥–∞–∑'

            # –¢–æ –∂–µ –¥–ª—è name2
            # –ö–∞–Ω–∞–ª–∏–∑–∞—Ü–∏—è
            if '–∫–∞–Ω–∞–ª–∏–∑' in name2.lower():
                purpose2 = '–∫–∞–Ω–∞–ª–∏–∑–∞—Ü–∏—è'
            # –•–æ–ª–æ–¥–Ω–∞—è –≤–æ–¥–∞
            elif '—Ö–≤—Å' in name2.lower() or '—Ö–æ–ª–æ–¥–Ω' in name2.lower() or '–¥–ª—è –≤–æ–¥—ã' in name2.lower():
                purpose2 = '—Ö–≤—Å'
            # –ì–æ—Ä—è—á–∞—è –≤–æ–¥–∞
            elif '–≥–≤—Å' in name2.lower() or '–≥–æ—Ä—è—á' in name2.lower():
                purpose2 = '–≥–≤—Å'
            # –û—Ç–æ–ø–ª–µ–Ω–∏–µ
            elif '–æ—Ç–æ–ø–ª–µ–Ω' in name2.lower():
                purpose2 = '–æ—Ç–æ–ø–ª–µ–Ω–∏–µ'
            # –ì–∞–∑
            elif '–≥–∞–∑' in name2.lower():
                purpose2 = '–≥–∞–∑'

            # –ï—Å–ª–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –∏ –†–ê–ó–ù–´–ï - —ç—Ç–æ –†–ê–ó–ù–´–ï —Ç–æ–≤–∞—Ä—ã!
            if purpose1 and purpose2 and purpose1 != purpose2:
                penalty = min(penalty, 0.30)  # –•–í–° vs –ì–í–° = –†–ê–ó–ù–´–ï

            # –ù–û–í–û–ï: –ü—Ä–æ–≤–µ—Ä–∫–∞ SDR (–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –¥–∏–∞–º–µ—Ç—Ä–∞ –∫ —Ç–æ–ª—â–∏–Ω–µ —Å—Ç–µ–Ω–∫–∏)
            sdr1 = re.search(r'sdr\s*(\d+)', name1.lower())
            sdr2 = re.search(r'sdr\s*(\d+)', name2.lower())

            if sdr1 and sdr2:
                s1 = int(sdr1.group(1))
                s2 = int(sdr2.group(1))

                # –ï—Å–ª–∏ SDR —Ä–∞–∑–Ω—ã–π - —Ä–∞–∑–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏
                if s1 != s2:
                    penalty = min(penalty, 0.30)  # SDR11 vs SDR17 = –†–ê–ó–ù–´–ï

        # 19. –§–õ–ê–ù–ï–¶ - –ø—Ä–æ–≤–µ—Ä—è–µ–º –î—É (–¥–∏–∞–º–µ—Ç—Ä) –∏ –†—É (–¥–∞–≤–ª–µ–Ω–∏–µ)
        if '—Ñ–ª–∞–Ω–µ—Ü' in name1.lower() and '—Ñ–ª–∞–Ω–µ—Ü' in name2.lower():
            # –ú–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ —Ñ–ª–∞–Ω—Ü–∞: 1-150-16 –∏–ª–∏ 1200-25-11-–í
            # –§–æ—Ä–º–∞—Ç: [—Ç–∏–ø]-[–î—É]-[–†—É]-[–∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ]
            # –ì–¥–µ: –î—É - —É—Å–ª–æ–≤–Ω—ã–π –¥–∏–∞–º–µ—Ç—Ä (–∫—Ä–∏—Ç–∏—á–Ω–æ!)
            #      –†—É - –¥–∞–≤–ª–µ–Ω–∏–µ (–∫—Ä–∏—Ç–∏—á–Ω–æ!)

            # –ò—â–µ–º –ø–∞—Ç—Ç–µ—Ä–Ω: —Ü–∏—Ñ—Ä—ã-—Ü–∏—Ñ—Ä—ã-—Ü–∏—Ñ—Ä—ã
            pattern1 = re.search(r'(\d+)[-](\d+)[-](\d+)', name1.lower())
            pattern2 = re.search(r'(\d+)[-](\d+)[-](\d+)', name2.lower())

            if pattern1 and pattern2:
                # –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
                type1 = int(pattern1.group(1))  # –¢–∏–ø –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è (1, 100, 1200 –∏ —Ç.–¥.)
                du1 = int(pattern1.group(2))    # –î—É - —É—Å–ª–æ–≤–Ω—ã–π –¥–∏–∞–º–µ—Ç—Ä
                ru1 = int(pattern1.group(3))    # –†—É - –¥–∞–≤–ª–µ–Ω–∏–µ

                type2 = int(pattern2.group(1))
                du2 = int(pattern2.group(2))
                ru2 = int(pattern2.group(3))

                # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
                # –ú–∞–ª–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ (1 vs 2, 100 vs 200) - –¥–æ–ø—É—Å—Ç–∏–º–∞
                # –ë–æ–ª—å—à–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ (100 vs 1200, 1 vs 1200) - –†–ê–ó–ù–´–ï —Ç–æ–≤–∞—Ä—ã
                type_diff = abs(type1 - type2)
                if type_diff > 100:  # –ë–æ–ª—å—à–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ –≤ —Ç–∏–ø–µ
                    penalty = min(penalty, 0.30)  # –†–ê–ó–ù–´–ï —Ñ–ª–∞–Ω—Ü—ã
                elif type1 != type2:  # –ú–∞–ª–∞—è —Ä–∞–∑–Ω–∏—Ü–∞
                    penalty = min(penalty, 0.85)  # –ü–æ—Ö–æ–∂–∏, –Ω–æ –Ω–µ –∏–¥–µ–Ω—Ç–∏—á–Ω—ã

                # –ü—Ä–æ–≤–µ—Ä–∫–∞ –î—É (–¥–∏–∞–º–µ—Ç—Ä–∞) - –ö–†–ò–¢–ò–ß–ù–û!
                if abs(du1 - du2) > 10:  # –†–∞–∑–Ω–∏—Ü–∞ –±–æ–ª—å—à–µ 10–º–º
                    penalty = min(penalty, 0.30)  # –§–ª–∞–Ω–µ—Ü 150 vs 65 = –†–ê–ó–ù–´–ï

                # –ü—Ä–æ–≤–µ—Ä–∫–∞ –†—É (–¥–∞–≤–ª–µ–Ω–∏—è) - –ö–†–ò–¢–ò–ß–ù–û!
                if abs(ru1 - ru2) > 5:  # –†–∞–∑–Ω–∏—Ü–∞ –±–æ–ª—å—à–µ 5 (–Ω–∞–ø—Ä–∏–º–µ—Ä, 16 vs 6)
                    penalty = min(penalty, 0.40)  # –§–ª–∞–Ω–µ—Ü –†—É16 vs –†—É6 = —Ä–∞–∑–Ω—ã–µ

            # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è —Ñ–ª–∞–Ω—Ü–µ–≤ —Ç–∏–ø–∞ "–§–ª–∞–Ω–µ—Ü 65-16"
            if not pattern1:
                pattern1 = re.search(r'(\d+)[-](\d+)', name1.lower())
            if not pattern2:
                pattern2 = re.search(r'(\d+)[-](\d+)', name2.lower())

            if pattern1 and pattern2 and not (pattern1.groups() == 3):
                du1 = int(pattern1.group(1))  # –ü–µ—Ä–≤–æ–µ —á–∏—Å–ª–æ - –î—É
                ru1 = int(pattern1.group(2))  # –í—Ç–æ—Ä–æ–µ —á–∏—Å–ª–æ - –†—É

                du2 = int(pattern2.group(1))
                ru2 = int(pattern2.group(2))

                # –ü—Ä–æ–≤–µ—Ä–∫–∞ –î—É
                if abs(du1 - du2) > 10:
                    penalty = min(penalty, 0.30)

                # –ü—Ä–æ–≤–µ—Ä–∫–∞ –†—É
                if abs(ru1 - ru2) > 5:
                    penalty = min(penalty, 0.40)

        # 19a. –ó–ê–ì–õ–£–®–ö–ê - –ø—Ä–æ–≤–µ—Ä—è–µ–º –î—É (—É—Å–ª–æ–≤–Ω—ã–π –¥–∏–∞–º–µ—Ç—Ä), —Ç–∏–ø, —Ä–∞–∑–º–µ—Ä—ã
        if '–∑–∞–≥–ª—É—à–∫–∞' in name1.lower() and '–∑–∞–≥–ª—É—à–∫–∞' in name2.lower():
            # –§–æ—Ä–º–∞—Ç—ã:
            # 1. "–ó–∞–≥–ª—É—à–∫–∞ 1-1200-25" (—Ñ–æ—Ä–º–∞—Ç —Ñ–ª–∞–Ω—Ü–∞: —Ç–∏–ø-–î—É-–†—É)
            # 2. "–ó–∞–≥–ª—É—à–∫–∞ –î—É 15", "–ó–∞–≥–ª—É—à–∫–∞ –î—É25"
            # 3. "–ó–∞–≥–ª—É—à–∫–∞ 159—Ö4", "–ó–∞–≥–ª—É—à–∫–∞ 100—Ö4" (–¥–∏–∞–º–µ—Ç—Ä√ó—Ç–æ–ª—â–∏–Ω–∞)
            # 4. "–ó–∞–≥–ª—É—à–∫–∞ —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–∞—è 159—Ö4" (—Ç–∏–ø + —Ä–∞–∑–º–µ—Ä—ã)

            # –ü–†–ò–û–†–ò–¢–ï–¢ 1: –§–æ—Ä–º–∞—Ç —Ñ–ª–∞–Ω—Ü–∞ "1-1200-25" (—Ç–∏–ø-–î—É-–†—É)
            pattern1 = re.search(r'(\d+)[-](\d+)[-](\d+(?:[.,]\d+)?)', name1.lower())
            pattern2 = re.search(r'(\d+)[-](\d+)[-](\d+(?:[.,]\d+)?)', name2.lower())

            diameter1 = None
            diameter2 = None
            pressure1 = None
            pressure2 = None

            if pattern1 and pattern2:
                # –§–æ—Ä–º–∞—Ç: —Ç–∏–ø-–î—É-–†—É
                # –ù–∞–º –≤–∞–∂–Ω—ã –î—É (–≤—Ç–æ—Ä–æ–µ —á–∏—Å–ª–æ) –ò –†—É (—Ç—Ä–µ—Ç—å–µ —á–∏—Å–ª–æ)
                diameter1 = int(pattern1.group(2))  # –î—É
                diameter2 = int(pattern2.group(2))  # –î—É

                # –ò–∑–≤–ª–µ–∫–∞–µ–º –†—É (–¥–∞–≤–ª–µ–Ω–∏–µ)
                pressure1 = float(pattern1.group(3).replace(',', '.'))  # –†—É (–º–æ–∂–µ—Ç –±—ã—Ç—å 0.6)
                pressure2 = float(pattern2.group(3).replace(',', '.'))  # –†—É

            # –ü–†–ò–û–†–ò–¢–ï–¢ 2: –§–æ—Ä–º–∞—Ç "–¥–∏–∞–º–µ—Ç—Ä√ó—Ç–æ–ª—â–∏–Ω–∞" (–∫–∞–∫ —Ç—Ä—É–±–∞)
            if not diameter1:
                dim1 = re.search(r'(\d+)\s*[—Ö*√óx]\s*(\d+)', name1.lower())
                if dim1:
                    diameter1 = int(dim1.group(1))  # –î–∏–∞–º–µ—Ç—Ä

            if not diameter2:
                dim2 = re.search(r'(\d+)\s*[—Ö*√óx]\s*(\d+)', name2.lower())
                if dim2:
                    diameter2 = int(dim2.group(1))  # –î–∏–∞–º–µ—Ç—Ä

            # –ü–†–ò–û–†–ò–¢–ï–¢ 3: –§–æ—Ä–º–∞—Ç "–î—É XX"
            if not diameter1:
                du1 = re.search(r'–¥—É\s*(\d+)', name1.lower())
                if du1:
                    diameter1 = int(du1.group(1))

            if not diameter2:
                du2 = re.search(r'–¥—É\s*(\d+)', name2.lower())
                if du2:
                    diameter2 = int(du2.group(1))

            # –ü–†–ò–û–†–ò–¢–ï–¢ 4: –ü—Ä–æ—Å—Ç–æ–µ —á–∏—Å–ª–æ –ø–æ—Å–ª–µ "–∑–∞–≥–ª—É—à–∫–∞"
            if not diameter1:
                simple1 = re.search(r'–∑–∞–≥–ª—É—à–∫–∞\s+(\d+)', name1.lower())
                if simple1:
                    diameter1 = int(simple1.group(1))

            if not diameter2:
                simple2 = re.search(r'–∑–∞–≥–ª—É—à–∫–∞\s+(\d+)', name2.lower())
                if simple2:
                    diameter2 = int(simple2.group(1))

            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–∞–º–µ—Ç—Ä–∞/–î—É - –ö–†–ò–¢–ò–ß–ù–û!
            if diameter1 and diameter2:
                if diameter1 != diameter2:  # –õ—é–±–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ = –†–ê–ó–ù–´–ï
                    penalty = min(penalty, 0.30)  # –ó–∞–≥–ª—É—à–∫–∞ 1200 vs 63 = –†–ê–ó–ù–´–ï

            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –†—É (–¥–∞–≤–ª–µ–Ω–∏—è) - –ö–†–ò–¢–ò–ß–ù–û –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∞ —Ñ–ª–∞–Ω—Ü–∞!
            if pressure1 is not None and pressure2 is not None:
                if abs(pressure1 - pressure2) > 5:  # –†–∞–∑–Ω–∏—Ü–∞ –±–æ–ª—å—à–µ 5 (–∫–∞–∫ —É —Ñ–ª–∞–Ω—Ü–µ–≤)
                    penalty = min(penalty, 0.40)  # –ó–∞–≥–ª—É—à–∫–∞ –†—É25 vs –†—É16 = –†–ê–ó–ù–´–ï

            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¢–ò–ü–ê –∑–∞–≥–ª—É—à–∫–∏
            type1 = None
            type2 = None

            if '—ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫' in name1.lower():
                type1 = '—ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–∞—è'
            if '—ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫' in name2.lower():
                type2 = '—ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–∞—è'

            # –ï—Å–ª–∏ —Ç–∏–ø—ã —Ä–∞–∑–Ω—ã–µ - –†–ê–ó–ù–´–ï –∑–∞–≥–ª—É—à–∫–∏
            if type1 != type2 and (type1 or type2):
                penalty = min(penalty, 0.40)  # –≠–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–∞—è vs –æ–±—ã—á–Ω–∞—è = –†–ê–ó–ù–´–ï

        # 19b. –û–¢–í–û–î - –ø—Ä–æ–≤–µ—Ä—è–µ–º —É–≥–æ–ª, –¥–∏–∞–º–µ—Ç—Ä, —Ç–æ–ª—â–∏–Ω—É, —Ç–∏–ø
        if '–æ—Ç–≤–æ–¥' in name1.lower() and '–æ—Ç–≤–æ–¥' in name2.lower():
            # –§–æ—Ä–º–∞—Ç—ã:
            # 1. "–û—Ç–≤–æ–¥ 90 76√ó5" (—É–≥–æ–ª + –¥–∏–∞–º–µ—Ç—Ä√ó—Ç–æ–ª—â–∏–Ω–∞)
            # 2. "–û—Ç–≤–æ–¥ 90-1-60.3√ó4" (—É–≥–æ–ª-—Ç–∏–ø-–¥–∏–∞–º–µ—Ç—Ä√ó—Ç–æ–ª—â–∏–Ω–∞)
            # 3. "–û—Ç–≤–æ–¥ –∫—Ä—É—Ç–æ–∏–∑–æ–≥–Ω—É—Ç—ã–π –î–Ω 114√ó5.0" (—Ç–∏–ø + —Ä–∞–∑–º–µ—Ä—ã)
            # 4. "–û—Ç–≤–æ–¥ –ü 90 114√ó5-20" (—Ç–∏–ø –ü + —É–≥–æ–ª + —Ä–∞–∑–º–µ—Ä—ã)
            # 5. "–û—Ç–≤–æ–¥ 90¬∞ 57√ó4" (—É–≥–æ–ª —Å —Å–∏–º–≤–æ–ª–æ–º –≥—Ä–∞–¥—É—Å–∞)

            # –ò–∑–≤–ª–µ–∫–∞–µ–º –£–ì–û–õ
            angle1 = re.search(r'(?:–æ—Ç–≤–æ–¥|–ø)\s*(\d+)¬∞?', name1.lower())
            angle2 = re.search(r'(?:–æ—Ç–≤–æ–¥|–ø)\s*(\d+)¬∞?', name2.lower())

            if angle1 and angle2:
                a1 = int(angle1.group(1))
                a2 = int(angle2.group(1))

                # –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–≥–ª–∞ (90¬∞ vs 45¬∞ = –†–ê–ó–ù–´–ï)
                if a1 != a2:
                    penalty = min(penalty, 0.30)  # –û—Ç–≤–æ–¥ 90¬∞ vs 45¬∞ = –†–ê–ó–ù–´–ï

            # –ò–∑–≤–ª–µ–∫–∞–µ–º –î–ò–ê–ú–ï–¢–† –∏ –¢–û–õ–©–ò–ù–£
            # –ü–∞—Ç—Ç–µ—Ä–Ω: "76√ó5", "60.3√ó4", "114√ó5.0"
            dims1 = re.search(r'(\d+(?:[.,]\d+)?)\s*[—Ö*√óx]\s*(\d+(?:[.,]\d+)?)', name1.lower())
            dims2 = re.search(r'(\d+(?:[.,]\d+)?)\s*[—Ö*√óx]\s*(\d+(?:[.,]\d+)?)', name2.lower())

            if dims1 and dims2:
                d1 = float(dims1.group(1).replace(',', '.'))
                t1 = float(dims1.group(2).replace(',', '.'))

                d2 = float(dims2.group(1).replace(',', '.'))
                t2 = float(dims2.group(2).replace(',', '.'))

                # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–∞–º–µ—Ç—Ä–∞ (–ö–†–ò–¢–ò–ß–ù–û!)
                # –ß–µ–º –º–µ–Ω—å—à–µ –¥–∏–∞–º–µ—Ç—Ä, —Ç–µ–º —Å—Ç—Ä–æ–∂–µ –ø—Ä–æ–≤–µ—Ä–∫–∞:
                # - –û—á–µ–Ω—å –º–∞–ª—ã–µ (<50–º–º): >=1.5–º–º –∫—Ä–∏—Ç–∏—á–Ω–æ
                # - –ú–∞–ª—ã–µ (50-100–º–º): >=3–º–º –∫—Ä–∏—Ç–∏—á–Ω–æ
                # - –ë–æ–ª—å—à–∏–µ (>=100–º–º): >=5–º–º –∫—Ä–∏—Ç–∏—á–Ω–æ
                max_d = max(d1, d2)

                if max_d < 50:
                    # –û—á–µ–Ω—å –º–∞–ª—ã–µ –æ—Ç–≤–æ–¥—ã: 21.3 vs 25, 26.9 vs 25
                    if abs(d1 - d2) >= 1.5:  # –î–∞–∂–µ 1.9–º–º = –†–ê–ó–ù–´–ï
                        penalty = min(penalty, 0.30)
                elif max_d < 100:
                    # –ú–∞–ª—ã–µ –æ—Ç–≤–æ–¥—ã: 57 vs 60.3, 76 vs 80
                    if abs(d1 - d2) >= 3:  # –†–∞–∑–Ω–∏—Ü–∞ 3–º–º –∏ –±–æ–ª–µ–µ = –†–ê–ó–ù–´–ï
                        penalty = min(penalty, 0.30)
                else:
                    # –ë–æ–ª—å—à–∏–µ –æ—Ç–≤–æ–¥—ã: 159 vs 219 –∏ —Ç.–¥.
                    if abs(d1 - d2) >= 5:  # –†–∞–∑–Ω–∏—Ü–∞ 5–º–º –∏ –±–æ–ª–µ–µ = –†–ê–ó–ù–´–ï
                        penalty = min(penalty, 0.30)

                # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–ª—â–∏–Ω—ã —Å—Ç–µ–Ω–∫–∏
                if abs(t1 - t2) >= 1:  # –¢–æ–ª—â–∏–Ω–∞ 5 vs 4 = –†–ê–ó–ù–´–ï
                    penalty = min(penalty, 0.30)

            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¢–ò–ü–ê –æ—Ç–≤–æ–¥–∞
            type1 = None
            type2 = None

            if '–∫—Ä—É—Ç–æ–∏–∑–æ–≥–Ω—É—Ç' in name1.lower():
                type1 = '–∫—Ä—É—Ç–æ–∏–∑–æ–≥–Ω—É—Ç—ã–π'
            elif '–ø 90' in name1.lower() or '–ø90' in name1.lower():
                type1 = '–ø–æ–≤–æ—Ä–æ—Ç–Ω—ã–π'

            if '–∫—Ä—É—Ç–æ–∏–∑–æ–≥–Ω—É—Ç' in name2.lower():
                type2 = '–∫—Ä—É—Ç–æ–∏–∑–æ–≥–Ω—É—Ç—ã–π'
            elif '–ø 90' in name2.lower() or '–ø90' in name2.lower():
                type2 = '–ø–æ–≤–æ—Ä–æ—Ç–Ω—ã–π'

            # –ï—Å–ª–∏ —Ç–∏–ø—ã —Ä–∞–∑–Ω—ã–µ - –†–ê–ó–ù–´–ï –æ—Ç–≤–æ–¥—ã
            if type1 != type2 and (type1 or type2):
                penalty = min(penalty, 0.40)  # –ö—Ä—É—Ç–æ–∏–∑–æ–≥–Ω—É—Ç—ã–π vs –ø–æ–≤–æ—Ä–æ—Ç–Ω—ã–π = –†–ê–ó–ù–´–ï

        # 20. –ö–†–£–ì - –ø—Ä–æ–≤–µ—Ä—è–µ–º –¥–∏–∞–º–µ—Ç—Ä
        if '–∫—Ä—É–≥' in name1.lower() and '–∫—Ä—É–≥' in name2.lower():
            # –ò—â–µ–º –¥–∏–∞–º–µ—Ç—Ä: "–ö—Ä—É–≥ 18", "–ö—Ä—É–≥ 10 –ì–û–°–¢", "–ö—Ä—É–≥ 18—Ö5000–ú–ú"
            d1 = re.search(r'–∫—Ä—É–≥\s+(\d+)', name1.lower())
            d2 = re.search(r'–∫—Ä—É–≥\s+(\d+)', name2.lower())

            if d1 and d2:
                diameter1 = int(d1.group(1))
                diameter2 = int(d2.group(1))

                # –ï—Å–ª–∏ –¥–∏–∞–º–µ—Ç—Ä –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –Ω–∞ 2–º–º –∏ –±–æ–ª—å—à–µ - –†–ê–ó–ù–´–ï
                if abs(diameter1 - diameter2) >= 2:  # –ö—Ä—É–≥ 18 vs 16 = –†–ê–ó–ù–´–ï
                    penalty = min(penalty, 0.30)

        # 21. –ü–†–û–ö–õ–ê–î–ö–ê - –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä (–ê-1000, –ê-800, 1-800 –∏ —Ç.–¥.)
        if '–ø—Ä–æ–∫–ª–∞–¥–∫–∞' in name1.lower() and '–ø—Ä–æ–∫–ª–∞–¥–∫–∞' in name2.lower():
            # –ü–∞—Ç—Ç–µ—Ä–Ω: –ê-1000-16, 1-800-0.3, –ë-100-16, 50-10 –∏ —Ç.–¥.
            # –õ–æ–≥–∏–∫–∞: –µ—Å–ª–∏ –ø–µ—Ä–≤–æ–µ —á–∏—Å–ª–æ < 10, —Ç–æ —Ä–∞–∑–º–µ—Ä = –≤—Ç–æ—Ä–æ–µ —á–∏—Å–ª–æ
            #         –∏–Ω–∞—á–µ —Ä–∞–∑–º–µ—Ä = –ø–µ—Ä–≤–æ–µ —á–∏—Å–ª–æ

            # –ò—â–µ–º –ø–∞—Ç—Ç–µ—Ä–Ω: —á–∏—Å–ª–æ-—á–∏—Å–ª–æ
            pattern1 = re.search(r'(\d+)[-](\d+)', name1.lower())
            pattern2 = re.search(r'(\d+)[-](\d+)', name2.lower())

            if pattern1 and pattern2:
                first1 = int(pattern1.group(1))
                second1 = int(pattern1.group(2))

                first2 = int(pattern2.group(1))
                second2 = int(pattern2.group(2))

                # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–∞–∑–º–µ—Ä –ø–æ –ª–æ–≥–∏–∫–µ
                size1 = second1 if first1 < 10 else first1  # 1-800 ‚Üí 800, –ê-1000 ‚Üí 1000
                size2 = second2 if first2 < 10 else first2

                # –ï—Å–ª–∏ —Ä–∞–∑–º–µ—Ä —Å–∏–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è - –†–ê–ó–ù–´–ï
                if abs(size1 - size2) >= 50:  # –†–∞–∑–Ω–∏—Ü–∞ >= 50–º–º
                    penalty = min(penalty, 0.30)

        # 22. –¢–†–£–ë–ê - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–∞–º–µ—Ç—Ä–∞ –¥–ª—è —Ç—Ä—É–± –ë–ï–ó —Ä–∞–∑–º–µ—Ä–æ–≤ –≤–∏–¥–∞ "–¢—Ä—É–±–∞ –ü–í–• 25"
        if '—Ç—Ä—É–±–∞' in name1.lower() and '—Ç—Ä—É–±–∞' in name2.lower():
            # –£–∂–µ –µ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è —Ç—Ä—É–± —Å —Ö (100—Ö5), –Ω–æ –Ω—É–∂–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è "–¢—Ä—É–±–∞ –ü–í–• 25"

            # –ò—â–µ–º –æ–¥–∏–Ω–æ—á–Ω—ã–π –¥–∏–∞–º–µ—Ç—Ä –±–µ–∑ —Ö: "–¢—Ä—É–±–∞ –ü–í–• 25", "–¢—Ä—É–±–∞ –ü–í–• 100"
            d1_alone = re.search(r'—Ç—Ä—É–±–∞\s+\S+\s+(\d+)', name1.lower())
            d2_alone = re.search(r'—Ç—Ä—É–±–∞\s+\S+\s+(\d+)', name2.lower())

            # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω: –ø—Ä–æ—Å—Ç–æ —á–∏—Å–ª–æ –ø–æ—Å–ª–µ –ü–í–•
            if not d1_alone:
                d1_alone = re.search(r'–ø–≤—Ö\s+(\d+)', name1.lower())
            if not d2_alone:
                d2_alone = re.search(r'–ø–≤—Ö\s+(\d+)', name2.lower())

            if d1_alone and d2_alone:
                dia1 = int(d1_alone.group(1))
                dia2 = int(d2_alone.group(1))

                # –ï—Å–ª–∏ –¥–∏–∞–º–µ—Ç—Ä –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –±–æ–ª—å—à–µ —á–µ–º –Ω–∞ 10–º–º - –†–ê–ó–ù–´–ï
                if abs(dia1 - dia2) > 10:
                    penalty = min(penalty, 0.30)

        # 23. –ö–†–ê–ù - –ø—Ä–æ–≤–µ—Ä—è–µ–º –¥–∏–∞–º–µ—Ç—Ä
        if '–∫—Ä–∞–Ω' in name1.lower() and '–∫—Ä–∞–Ω' in name2.lower():
            # –ò—â–µ–º –¥–∏–∞–º–µ—Ç—Ä: √ò15, √ò20, –î-20, d20, –¥-20 (—Ä—É—Å—Å–∫–∞—è –¥!)
            d1 = re.search(r'[√∏√òd–¥–î][-\s]*(\d+)', name1.lower())
            d2 = re.search(r'[√∏√òd–¥–î][-\s]*(\d+)', name2.lower())

            if d1 and d2:
                diameter1 = int(d1.group(1))
                diameter2 = int(d2.group(1))

                # –ï—Å–ª–∏ –¥–∏–∞–º–µ—Ç—Ä –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è - –†–ê–ó–ù–´–ï
                if abs(diameter1 - diameter2) >= 5:  # –†–∞–∑–Ω–∏—Ü–∞ >= 5–º–º
                    penalty = min(penalty, 0.30)

        # 24. –£–ì–û–õ–û–ö - –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä—ã –∏ —Ç–∏–ø
        if '—É–≥–æ–ª–æ–∫' in name1.lower() and '—É–≥–æ–ª–æ–∫' in name2.lower():
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞: –Ω–∞—Ä—É–∂–Ω—ã–π vs –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π
            if ('–Ω–∞—Ä—É–∂–Ω' in name1.lower() and '–≤–Ω—É—Ç—Ä' in name2.lower()) or \
                    ('–≤–Ω—É—Ç—Ä' in name1.lower() and '–Ω–∞—Ä—É–∂–Ω' in name2.lower()):
                penalty = min(penalty, 0.30)  # –ù–∞—Ä—É–∂–Ω—ã–π vs –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π = –†–ê–ó–ù–´–ï

            # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–æ–≤: 63—Ö63—Ö5, 63*6, 50*5
            # –ò—â–µ–º –ø–∞—Ç—Ç–µ—Ä–Ω: —á–∏—Å–ª–∞ —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è–º–∏
            dims1 = re.findall(r'\d+', name1.lower())
            dims2 = re.findall(r'\d+', name2.lower())

            if len(dims1) >= 1 and len(dims2) >= 1:
                # –ë–µ—Ä–µ–º –ø–µ—Ä–≤—ã–µ —á–∏—Å–ª–∞ –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã
                # –î–ª—è —É–≥–æ–ª–∫–∞ –≤–∞–∂–Ω—ã: —à–∏—Ä–∏–Ω–∞ –∏ —Ç–æ–ª—â–∏–Ω–∞

                # –ï—Å–ª–∏ –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã 2 —á–∏—Å–ª–∞ –≤ –æ–¥–Ω–æ–º –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏–π, –ø—Ä–æ–≤–µ—Ä—è–µ–º
                if len(dims1) >= 2 or len(dims2) >= 2:
                    # –ü–æ—Å–ª–µ–¥–Ω–µ–µ —á–∏—Å–ª–æ –æ–±—ã—á–Ω–æ —Ç–æ–ª—â–∏–Ω–∞
                    thick1 = int(dims1[-1]) if len(dims1) >= 1 else 0
                    thick2 = int(dims2[-1]) if len(dims2) >= 1 else 0

                    # –ü–µ—Ä–≤–æ–µ —á–∏—Å–ª–æ - —à–∏—Ä–∏–Ω–∞ –ø–æ–ª–∫–∏
                    width1 = int(dims1[0]) if len(dims1) >= 1 else 0
                    width2 = int(dims2[0]) if len(dims2) >= 1 else 0

                    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–ª—â–∏–Ω—ã (–ö–†–ò–¢–ò–ß–ù–û - –¥–∞–∂–µ 1–º–º —Ä–∞–∑–Ω–∏—Ü–∞ –≤–∞–∂–Ω–∞!)
                    if thick1 != thick2 and thick1 > 0 and thick2 > 0:
                        penalty = min(penalty, 0.30)  # –£–≥–æ–ª–æ–∫ 5–º–º vs 6–º–º = –†–ê–ó–ù–´–ï

                    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —à–∏—Ä–∏–Ω—ã
                    if abs(width1 - width2) > 10:  # –†–∞–∑–Ω–∏—Ü–∞ –±–æ–ª—å—à–µ 10–º–º
                        penalty = min(penalty, 0.30)

        # 25. –°–ê–õ–¨–ù–ò–ö - –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä
        if '—Å–∞–ª—å–Ω–∏–∫' in name1.lower() and '—Å–∞–ª—å–Ω–∏–∫' in name2.lower():
            # –ò—â–µ–º —á–∏—Å–ª–æ: "–°–∞–ª—å–Ω–∏–∫ 100", "–°–∞–ª—å–Ω–∏–∫ 50"
            d1 = re.search(r'—Å–∞–ª—å–Ω–∏–∫\s+(\d+)', name1.lower())
            d2 = re.search(r'—Å–∞–ª—å–Ω–∏–∫\s+(\d+)', name2.lower())

            if d1 and d2:
                size1 = int(d1.group(1))
                size2 = int(d2.group(1))

                # –ï—Å–ª–∏ —Ä–∞–∑–º–µ—Ä –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –±–æ–ª—å—à–µ —á–µ–º –Ω–∞ 10 - –†–ê–ó–ù–´–ï
                if abs(size1 - size2) > 10:
                    penalty = min(penalty, 0.30)

        # 26. –ü–†–û–§–ò–õ–¨ - –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä—ã (–∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–π/–ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω—ã–π)
        if '–ø—Ä–æ—Ñ–∏–ª—å' in name1.lower() and '–ø—Ä–æ—Ñ–∏–ª—å' in name2.lower():
            # –ò—â–µ–º —Ä–∞–∑–º–µ—Ä—ã: 50—Ö50—Ö5, 100—Ö100—Ö4, 200—Ö200—Ö6
            dims1 = re.search(r'(\d+)\s*[—Öx*√ó]\s*(\d+)\s*[—Öx*√ó]\s*(\d+)', name1.lower())
            dims2 = re.search(r'(\d+)\s*[—Öx*√ó]\s*(\d+)\s*[—Öx*√ó]\s*(\d+)', name2.lower())

            if dims1 and dims2:
                # –î–ª—è –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è: —à–∏—Ä–∏–Ω–∞ —Ö –≤—ã—Å–æ—Ç–∞ —Ö —Ç–æ–ª—â–∏–Ω–∞
                w1 = int(dims1.group(1))
                h1 = int(dims1.group(2))
                t1 = int(dims1.group(3))

                w2 = int(dims2.group(1))
                h2 = int(dims2.group(2))
                t2 = int(dims2.group(3))

                # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–æ–≤
                if abs(w1 - w2) > 10 or abs(h1 - h2) > 10:
                    penalty = min(penalty, 0.30)  # –ü—Ä–æ—Ñ–∏–ª—å 50—Ö50 vs 200—Ö200 = –†–ê–ó–ù–´–ï

                # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–ª—â–∏–Ω—ã (–ö–†–ò–¢–ò–ß–ù–û - –¥–æ–ª–∂–Ω–∞ —Å–æ–≤–ø–∞–¥–∞—Ç—å!)
                if t1 != t2:  # –î–∞–∂–µ 1–º–º —Ä–∞–∑–Ω–∏—Ü–∞ –∫—Ä–∏—Ç–∏—á–Ω–∞!
                    penalty = min(penalty, 0.30)  # –ü—Ä–æ—Ñ–∏–ª—å 100—Ö100—Ö5 vs 100—Ö100—Ö4 = –†–ê–ó–ù–´–ï

        # 27. –†–ê–ó–ù–´–ï –ö–ê–¢–ï–ì–û–†–ò–ò - —Å–µ—Ç–∫–∞ vs —à—Ç–æ–∫, –ª–∏—Å—Ç vs —Ç—Ä—É–±–∞ –∏ —Ç.–¥.
        # –ï—Å–ª–∏ –æ–¥–∏–Ω —Ç–æ–≤–∞—Ä - —Å–µ—Ç–∫–∞, –∞ –¥—Ä—É–≥–æ–π - —à—Ç–æ–∫, —ç—Ç–æ –†–ê–ó–ù–´–ï —Ç–æ–≤–∞—Ä—ã!
        categories_mismatch = [
            ('—Å–µ—Ç–∫–∞', '—à—Ç–æ–∫'),
            ('—Å–µ—Ç–∫–∞', '—Ç—Ä—É–±–∞'),
            ('—à—Ç–æ–∫', '—Ç—Ä—É–±–∞'),
            ('–ª–∏—Å—Ç', '—Ç—Ä—É–±–∞'),
            ('–ø–æ–ª–æ—Å–∞', '—Ç—Ä—É–±–∞'),
            ('–∫—Ä—É–≥', '—Ç—Ä—É–±–∞'),
        ]

        for cat1, cat2 in categories_mismatch:
            if (cat1 in name1.lower() and cat2 in name2.lower()) or \
                    (cat2 in name1.lower() and cat1 in name2.lower()):
                penalty = min(penalty, 0.30)  # –°–µ—Ç–∫–∞ vs –®—Ç–æ–∫ = –†–ê–ó–ù–´–ï

        # 28. –°–í–ê–†–û–ß–ù–´–ô –ê–ü–ü–ê–†–ê–¢ - –ø—Ä–æ–≤–µ—Ä—è–µ–º –º–æ–¥–µ–ª—å –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ç–æ–∫
        if ('–∞–ø–ø–∞—Ä–∞—Ç' in name1.lower() and '–∞–ø–ø–∞—Ä–∞—Ç' in name2.lower()) or \
                ('—Å–≤–∞—Ä–æ—á–Ω' in name1.lower() and '—Å–≤–∞—Ä–æ—á–Ω' in name2.lower()):

            # –ò–∑–≤–ª–µ–∫–∞–µ–º –º–æ–¥–µ–ª–∏: TIG 300, W229, –°–ê–ò-315, ARC 250 –∏ —Ç.–¥.
            # –ò—â–µ–º –±—É–∫–≤–µ–Ω–Ω–æ-—Ü–∏—Ñ—Ä–æ–≤—ã–µ –∫–æ–¥—ã
            models1 = re.findall(r'[A-Z–ê-–Ø]{2,}\s*\d+|[A-Z–ê-–Ø]\d+', name1.upper())
            models2 = re.findall(r'[A-Z–ê-–Ø]{2,}\s*\d+|[A-Z–ê-–Ø]\d+', name2.upper())

            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
            if models1 and models2:
                # –ï—Å–ª–∏ –Ω–∏ –æ–¥–Ω–∞ –º–æ–¥–µ–ª—å –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç - –†–ê–ó–ù–´–ï –∞–ø–ø–∞—Ä–∞—Ç—ã
                common_models = set(models1) & set(models2)
                if not common_models:
                    penalty = min(penalty, 0.40)  # TIG 300 vs ARC 250 = –†–ê–ó–ù–´–ï

            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ç–æ–∫: "250–ê", "200–ê", "315–ê"
            current1 = re.search(r'(\d+)–∞', name1.lower())
            current2 = re.search(r'(\d+)–∞', name2.lower())

            if current1 and current2:
                # –ë–µ—Ä–µ–º –ø–æ—Å–ª–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–æ–∫–∞ (–æ–±—ã—á–Ω–æ —ç—Ç–æ –º–∞–∫—Å–∏–º—É–º)
                all_currents1 = re.findall(r'(\d+)–∞', name1.lower())
                all_currents2 = re.findall(r'(\d+)–∞', name2.lower())

                if all_currents1 and all_currents2:
                    max_current1 = max(int(c) for c in all_currents1)
                    max_current2 = max(int(c) for c in all_currents2)

                    # –ï—Å–ª–∏ —Ä–∞–∑–Ω–∏—Ü–∞ –≤ —Ç–æ–∫–µ –±–æ–ª—å—à–µ 30–ê - –†–ê–ó–ù–´–ï
                    if abs(max_current1 - max_current2) > 30:
                        penalty = min(penalty, 0.35)  # 250–ê vs 200–ê –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ–ø—É—Å—Ç–∏–º–æ

        # 29. –î–ù–ò–©–ï - –ø—Ä–æ–≤–µ—Ä—è–µ–º –¥–∏–∞–º–µ—Ç—Ä, —Ç–æ–ª—â–∏–Ω—É, –≤—ã—Å–æ—Ç—É
        if '–¥–Ω–∏—â–µ' in name1.lower() and '–¥–Ω–∏—â–µ' in name2.lower():
            # –§–æ—Ä–º–∞—Ç: –î–Ω–∏—â–µ 1640-10-426, –î–Ω–∏—â–µ 2400-12-600, –î–Ω–∏—â–µ 2700-10
            # –ì–¥–µ: –¥–∏–∞–º–µ—Ç—Ä-—Ç–æ–ª—â–∏–Ω–∞-–≤—ã—Å–æ—Ç–∞

            # –ò—â–µ–º —Ç—Ä–∏ —á–∏—Å–ª–∞ –ø–æ–¥—Ä—è–¥: –¥–∏–∞–º–µ—Ç—Ä-—Ç–æ–ª—â–∏–Ω–∞-–≤—ã—Å–æ—Ç–∞
            dims1 = re.search(r'(\d+)[-](\d+)[-](\d+)', name1.lower())
            dims2 = re.search(r'(\d+)[-](\d+)[-](\d+)', name2.lower())

            # –ò–ª–∏ –¥–≤–∞ —á–∏—Å–ª–∞: –¥–∏–∞–º–µ—Ç—Ä-—Ç–æ–ª—â–∏–Ω–∞
            if not dims1:
                dims1 = re.search(r'(\d+)[-](\d+)', name1.lower())
            if not dims2:
                dims2 = re.search(r'(\d+)[-](\d+)', name2.lower())

            if dims1 and dims2:
                diameter1 = int(dims1.group(1))
                diameter2 = int(dims2.group(1))

                # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–∞–º–µ—Ç—Ä–∞ (–ö–†–ò–¢–ò–ß–ù–û!)
                if abs(diameter1 - diameter2) > 200:  # –†–∞–∑–Ω–∏—Ü–∞ –±–æ–ª—å—à–µ 200–º–º
                    penalty = min(penalty, 0.30)  # –î–Ω–∏—â–µ 1640 vs 2400 = –†–ê–ó–ù–´–ï

        # 30. –ú–£–§–¢–ê - –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∏–ø –∏ –¥–∏–∞–º–µ—Ç—Ä
        if '–º—É—Ñ—Ç–∞' in name1.lower() and '–º—É—Ñ—Ç–∞' in name2.lower():
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –º—É—Ñ—Ç—ã
            type1 = None
            type2 = None

            # –ö–∞–±–µ–ª—å–Ω–∞—è
            if '–∫–∞–±–µ–ª—å–Ω' in name1.lower():
                type1 = '–∫–∞–±–µ–ª—å–Ω–∞—è'
            # –°–æ–µ–¥–∏–Ω–∏—Ç–µ–ª—å–Ω–∞—è
            elif '—Å–æ–µ–¥–∏–Ω–∏—Ç–µ–ª—å–Ω' in name1.lower():
                type1 = '—Å–æ–µ–¥–∏–Ω–∏—Ç–µ–ª—å–Ω–∞—è'
            # –ö–æ–Ω—Ü–µ–≤–∞—è
            elif '–∫–æ–Ω—Ü–µ–≤' in name1.lower():
                type1 = '–∫–æ–Ω—Ü–µ–≤–∞—è'
            # –ü–µ—Ä–µ—Ö–æ–¥–Ω–∞—è
            elif '–ø–µ—Ä–µ—Ö' in name1.lower():
                type1 = '–ø–µ—Ä–µ—Ö–æ–¥–Ω–∞—è'

            if '–∫–∞–±–µ–ª—å–Ω' in name2.lower():
                type2 = '–∫–∞–±–µ–ª—å–Ω–∞—è'
            elif '—Å–æ–µ–¥–∏–Ω–∏—Ç–µ–ª—å–Ω' in name2.lower():
                type2 = '—Å–æ–µ–¥–∏–Ω–∏—Ç–µ–ª—å–Ω–∞—è'
            elif '–∫–æ–Ω—Ü–µ–≤' in name2.lower():
                type2 = '–∫–æ–Ω—Ü–µ–≤–∞—è'
            elif '–ø–µ—Ä–µ—Ö' in name2.lower():
                type2 = '–ø–µ—Ä–µ—Ö–æ–¥–Ω–∞—è'

            # –ï—Å–ª–∏ —Ç–∏–ø—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –∏ —Ä–∞–∑–Ω—ã–µ - —ç—Ç–æ –†–ê–ó–ù–´–ï —Ç–æ–≤–∞—Ä—ã!
            if type1 and type2 and type1 != type2:
                penalty = min(penalty, 0.35)  # –ö–∞–±–µ–ª—å–Ω–∞—è vs —Å–æ–µ–¥–∏–Ω–∏—Ç–µ–ª—å–Ω–∞—è = –†–ê–ó–ù–´–ï

            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–∏–∞–º–µ—Ç—Ä: √ò50, DN25, √∏32, d50
            d1 = re.search(r'[√∏√òd]\s*(\d+)', name1.lower())
            d2 = re.search(r'[√∏√òd]\s*(\d+)', name2.lower())

            if not d1:
                d1 = re.search(r'dn\s*(\d+)', name1.lower())
            if not d2:
                d2 = re.search(r'dn\s*(\d+)', name2.lower())

            if d1 and d2:
                diameter1 = int(d1.group(1))
                diameter2 = int(d2.group(1))

                # –ï—Å–ª–∏ –¥–∏–∞–º–µ—Ç—Ä —Å–∏–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è - —Ä–∞–∑–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã
                if abs(diameter1 - diameter2) > 10:  # –†–∞–∑–Ω–∏—Ü–∞ >10–º–º
                    ratio = min(diameter1, diameter2) / max(diameter1, diameter2)
                    penalty = min(penalty, 0.4 + ratio * 0.2)  # –ú—É—Ñ—Ç–∞ √ò50 vs √ò32 = —Ä–∞–∑–Ω—ã–µ

        return penalty

    @staticmethod
    def _normalize_string(s: str) -> str:
        """–ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç —Å—Ç—Ä–æ–∫—É –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è"""
        s = s.lower()
        # –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã
        s = ' '.join(s.split())
        # –£–±–∏—Ä–∞–µ–º —Ç–æ—á–∫–∏ –∏ –∑–∞–ø—è—Ç—ã–µ
        s = s.replace('.', '').replace(',', '.')
        return s

    @staticmethod
    def _compare_dimensions(features1: Dict, features2: Dict) -> float:
        """
        –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä—ã —Å –¥–æ–ø—É—Å–∫–æ–º

        Returns:
            float: —Å—Ö–æ–∂–µ—Å—Ç—å —Ä–∞–∑–º–µ—Ä–æ–≤ (0-1)
        """
        dimensions = ['diameter', 'thickness', 'length', 'width', 'height', 'number']

        matches = 0
        total = 0

        for dim in dimensions:
            val1 = features1.get(dim)
            val2 = features2.get(dim)

            if val1 is not None and val2 is not None:
                total += 1
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å –¥–æ–ø—É—Å–∫–æ–º 5%
                tolerance = 0.05
                diff = abs(val1 - val2)
                avg = (val1 + val2) / 2

                if avg > 0 and diff / avg <= tolerance:
                    matches += 1
                elif diff <= 1:  # –ê–±—Å–æ–ª—é—Ç–Ω—ã–π –¥–æ–ø—É—Å–∫ 1–º–º
                    matches += 1

        if total == 0:
            return 0.7  # –ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ, –µ—Å–ª–∏ —Ä–∞–∑–º–µ—Ä—ã –Ω–µ —É–∫–∞–∑–∞–Ω—ã

        return matches / total

    @staticmethod
    def find_matching_products(
            target_product: str,
            product_list: List[str],
            threshold: float = 0.85
    ) -> List[Tuple[str, float]]:
        """
        –ù–∞—Ö–æ–¥–∏—Ç —Å—Ö–æ–∂–∏–µ —Ç–æ–≤–∞—Ä—ã –≤ —Å–ø–∏—Å–∫–µ

        Args:
            target_product: —Ü–µ–ª–µ–≤–æ–π —Ç–æ–≤–∞—Ä
            product_list: —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –ø–æ–∏—Å–∫–∞
            threshold: –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥ —Å—Ö–æ–∂–µ—Å—Ç–∏

        Returns:
            list: —Å–ø–∏—Å–æ–∫ –∫–æ—Ä—Ç–µ–∂–µ–π (—Ç–æ–≤–∞—Ä, —Å—Ö–æ–∂–µ—Å—Ç—å), –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ —É–±—ã–≤–∞–Ω–∏—é —Å—Ö–æ–∂–µ—Å—Ç–∏
        """
        matches = []

        for product in product_list:
            if product == target_product:
                continue

            similarity = ProductMatcher.calculate_similarity(target_product, product)

            if similarity >= threshold:
                matches.append((product, similarity))

        # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —É–±—ã–≤–∞–Ω–∏—é —Å—Ö–æ–∂–µ—Å—Ç–∏
        matches.sort(key=lambda x: x[1], reverse=True)

        return matches

    @staticmethod
    def compare_products(product1: str, product2: str) -> Dict[str, Any]:
        """
        –î–µ—Ç–∞–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–≤—É—Ö —Ç–æ–≤–∞—Ä–æ–≤

        Args:
            product1: –ø–µ—Ä–≤—ã–π —Ç–æ–≤–∞—Ä
            product2: –≤—Ç–æ—Ä–æ–π —Ç–æ–≤–∞—Ä

        Returns:
            dict: –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏
        """
        features1 = ProductMatcher.extract_key_features(product1)
        features2 = ProductMatcher.extract_key_features(product2)

        similarity = ProductMatcher.calculate_similarity(product1, product2)

        # –ù–∞—Ö–æ–¥–∏–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
        matches = {}
        differences = {}

        for key in ['type', 'category', 'diameter', 'thickness', 'length',
                    'width', 'height', 'material', 'gost', 'model', 'brand']:
            val1 = features1.get(key)
            val2 = features2.get(key)

            if val1 is not None and val2 is not None:
                if val1 == val2:
                    matches[key] = val1
                else:
                    differences[key] = {
                        'product1': val1,
                        'product2': val2
                    }

        return {
            'similarity': similarity,
            'product1': product1,
            'product2': product2,
            'features1': features1,
            'features2': features2,
            'matches': matches,
            'differences': differences
        }


# –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —É–ª—É—á—à–µ–Ω–∏–π
if __name__ == "__main__":
    # –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ –≤–∞—à–µ–≥–æ —Ñ–∞–π–ª–∞
    test_cases = [
        ("–ú—É—Ñ—Ç–∞ –ü–ü–† 75", "–ú—É—Ñ—Ç–∞ –∞–º–µ—Ä–∏–∫–∞–Ω–∫–∞ –ü–ü–† 32–ú–ú –í–†"),
        ("–ö—Ä—É–≥ –∑–∞—á–∏—Å—Ç–Ω–æ–π 180—Ö6.0—Ö22", "–ö—Ä—É–≥ 16 –°—Ç20 –ì–û–°–¢ 1050-2013"),
        ("–ö—Ä–∞–Ω –ü–ü–† 63", "–ö—Ä–∞–Ω —à–∞—Ä–æ–≤–æ–π –î—É80"),
        ("–®–∞–π–±–∞ 16 –ì–û–°–¢ 11371-78", "–®–∞–π–±–∞ –ú12 ISO 7090"),
        ("–°—Ç—Ä–æ–ø —Ç–µ–∫—Å—Ç–∏–ª—å–Ω—ã–π –°–¢–ü 10,0(6 000)", "–°—Ç—Ä–æ–ø –∫–∞–Ω–∞—Ç–Ω—ã–π 4–°–ö 10,0 / 4000"),
    ]

    print("–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –£–õ–£–ß–®–ï–ù–ù–û–ì–û –ê–õ–ì–û–†–ò–¢–ú–ê:")
    print("=" * 80)

    for prod1, prod2 in test_cases:
        similarity = ProductMatcher.calculate_similarity(prod1, prod2)
        f1 = ProductMatcher.extract_key_features(prod1)
        f2 = ProductMatcher.extract_key_features(prod2)

        print(f"\n1: {prod1}")
        print(f"   –ö–∞—Ç–µ–≥–æ—Ä–∏—è: {f1['category']}, –¢–∏–ø: {f1['type']}")
        print(f"2: {prod2}")
        print(f"   –ö–∞—Ç–µ–≥–æ—Ä–∏—è: {f2['category']}, –¢–∏–ø: {f2['type']}")
        print(f"–°—Ö–æ–∂–µ—Å—Ç—å: {similarity:.1%}")
        print("-" * 80)